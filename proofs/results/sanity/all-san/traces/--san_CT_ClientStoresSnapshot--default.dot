digraph "trace_ct_SL2-AS0-CL0-A1-C1-NB_san_CT_ClientStoresSnapshot-Domain_Owner_Init-CA_Init-CA_Init-Logger_Init-Logger_Init-PreCertify-Root_CA_Init-Logger_Init-Logger_Init-add_preC_to_log-Logger_Init-Root_CA_Init-Start_Log-add_preC_to_log-Logger_Init-Root_CA_Init-Start_Log-ClientStoresSnapshot-Logger_Init-LoggerSnapshot_C-ClientStoresSnapshot-Logger_Init-LoggerSnapshot_C-Start_Log-Start_Log-add_preC_to_log-case_1-add_preC_to_log-case_2-CA_Init-add_preC_to_log-case_1-add_preC_to_log-case_2-PreCertify-CA_Init-PreCertify-CA_Init-PubKeyCertify-CA_Init_case_1-Domain_Owner_Init" {
nodesep="0.3";
ranksep="0.3";
node[fontsize="8",fontname="Helvetica",width="0.3",height="0.2"];
edge[fontsize="8",fontname="Helvetica"];
n3[shape="record",label="{{<n0> !Logger_s( $idL1, ~skL, pk(~skL) )}|{<n1> #t0 : Start_Log[StartedLog( $idL1, $log_id ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HonestStartedLog( $idL1, $log_id ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now )]\l}|{<n2> !Log( $idL1, $log_id )}}",fillcolor="#08a358",style="filled",fontcolor="white",role="Undefined"];
n13[shape="record",label="{{<n4> !DomainOwner( $id,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~sk)\l)\l|<n5> !CA_s0( $idCA, ~skCA, pk(~skCA),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, pk(~skCA), PU1, ~sn, $i0, $j\>, SI2\l)\l|<n6> Fr( ~sn.1 )}|{<n7> #t1 : PreCertify[PreCertified( $idCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<\<$idCA, $id, pk(~sk), 'pre-cert', ~sn.1, $i, $j.1\>, SI3\>\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GroundTruth( $idCA, \<$idCA, $id, pk(~sk), ~sn.1\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Asserts_PKI( $idCA, \<$idCA, $id, pk(~sk), ~sn.1\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $i )]\l}|{<n8> Out( \<$idCA, $id, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~sk), 'pre-cert', \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~sn.1, $i, $j.1\>\l)\l|<n9> Out( SI3 )|<n10> Certificate_Store( $idCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$idCA, $id, pk(~sk), \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'pre-cert', ~sn.1, $i, $j.1\>, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SI3\>\l)\l|<n11> Out( \<$rootCA, $idCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA), PU1, ~sn, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i0, $j\>\l)\l|<n12> Out( SI2 )}}",fillcolor="#c871ff",style="filled",fontcolor="black",role="Undefined"];
n23[shape="record",label="{{<n14> In( \<$idCA, $id, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~sk), 'pre-cert', \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~sn.1, $i, $j.1\>\l)\l|<n15> In( SI3 )|<n16> In( \<$rootCA, $idCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA), PU1, ~sn, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i0, $j\>\l)\l|<n17> In( SI2 )|<n18> !Logger_s( $idL1,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~skL, pk(~skL)\l)\l|<n19> !Root_CA( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PK2\l)\l|<n20> !Log( $idL1, $log_id\l)\l}|{<n21> #t2 : add_preC_to_log[Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerComputesAddLogStmt( $idL1, $log_id, \<$idCA, $id, pk(~sk), ~sn.1\>, $sct1 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerComputesAddLog( $idL1, $log_id,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$idCA, $id, pk(~sk), 'pre-cert', ~sn.1, $i, $j.1\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<\<\<$idCA, $id, pk(~sk), 'pre-cert', ~sn.1, $i, $j.1\>, SI3\>, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, pk(~skCA), PU1, ~sn, $i0, $j\>, SI2\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sct1\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerAsserts( $idL1, \<$idL1, 'SCT', $sct1, SI5\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $sct1 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckIssuedTime( $sct1, $i ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckValidUntil( $sct1, $j.1 )]\l}|{<n22> Out( \<$idL1, 'SCT', $sct1, SI5\> )}}",fillcolor="#08a358",style="filled",fontcolor="white",role="Undefined"];
n33[shape="record",label="{{<n24> In( \<$idCA, $id, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~sk), 'pre-cert', \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~sn.1, $i, $j.1\>\l)\l|<n25> In( SI3 )|<n26> In( \<$rootCA, $idCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA), PU1, ~sn, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i0, $j\>\l)\l|<n27> In( SI2 )|<n28> !Logger_s( $idL2,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~skL.1, PK1\l)\l|<n29> !Root_CA( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PK2\l)\l|<n30> !Log( $idL2,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$log_id.1\l)\l}|{<n31> #t3 : add_preC_to_log[Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerComputesAddLogStmt( $idL2, $log_id.1, \<$idCA, $id, pk(~sk), ~sn.1\>, $sct2 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerComputesAddLog( $idL2, $log_id.1,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$idCA, $id, pk(~sk), 'pre-cert', ~sn.1, $i, $j.1\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<\<\<$idCA, $id, pk(~sk), 'pre-cert', ~sn.1, $i, $j.1\>, SI3\>, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, pk(~skCA), PU1, ~sn, $i0, $j\>, SI2\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sct2\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerAsserts( $idL2, \<$idL2, 'SCT', $sct2, SI4\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $sct2 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckIssuedTime( $sct2, $i ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckValidUntil( $sct2, $j.1 )]\l}|{<n32> Out( \<$idL2, 'SCT', $sct2, SI4\> )}}",fillcolor="#08a358",style="filled",fontcolor="white",role="Undefined"];
n43[shape="record",label="{{<n34> !CA_s0( $idCA, ~skCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA), PU1, ~sn, $i0, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$j\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SI2\l)\l|<n35> In( \<$idL1, 'SCT', \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sct1, SI5\>\l)\l|<n36> In( \<$idL2, 'SCT', \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sct2, SI4\>\l)\l|<n37> !Logger( $idL1,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skL)\l)\l|<n38> !Logger( $idL2, PK1\l)\l|<n39> Certificate_Store( $idCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$idCA, $id, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~sk), \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'pre-cert', ~sn.1, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i, $j.1\>, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SI3\>\l)\l}|{<n40> #t4 : PubKeyCertify[Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Certified( $idCA, $idL1, \<$idL1, 'SCT', $sct1, SI5\>, $idL2, \<$idL2, 'SCT', $sct2, SI4\>\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CAAsserts( $idCA, \<$idCA, $id, pk(~sk), ~sn.1\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.1 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckIssuedTime( $now.1, $i ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckValidUntil( $now.1, $j.1 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Restr_PubKeyCertify_1( $idL1, $idL2 )]\l}|{<n41> Out( \<$idCA, $id, pk(~sk), 'pubKey', ~sn.1, $i, $j.1, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$idL1, 'SCT', $sct1, SI5\>, $idL2, 'SCT', $sct2, SI4\>\l)\l|<n42> Out( SI1 )}}",fillcolor="#c871ff",style="filled",fontcolor="black",role="Undefined"];
n54[shape="record",label="{{<n44> !Root_CA( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PK2\l)\l|<n45> In( \<$rootCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$idCA, pk(~skCA), \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PU1, ~sn, $i0, $j\>\l)\l|<n46> In( SI2 )|<n47> In( \<$idCA, $id, pk(~sk), 'pubKey', \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~sn.1, $i, $j.1, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$idL1, 'SCT', $sct1, SI5\>, $idL2, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'SCT', $sct2, SI4\>\l)\l|<n48> In( SI1 )|<n49> !Logger( $idL1,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skL)\l)\l|<n50> !Logger( $idL2, PK1\l)\l}|{<n51> #t5 : ClientValidate[ClientAcceptsChain( $idL1, $idL2, $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, pk(~skCA), PU1, ~sn, $i0, $j\>, $idCA, \<$idCA, $id, pk(~sk), ~sn.1\>\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ClientAcceptsCert( $idL1, $idL2, \<$idCA, $id, pk(~sk), 'pre-cert', ~sn.1, $i, $j.1\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.2 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckIssuedTime( $now.2, $i ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckValidUntil( $now.2, $j.1 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckIssuedTime( $now.2, $i0 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckValidUntil( $now.2, $j ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Restr_ClientValidate_1( $idL1, $idL2 )]\l}|{<n52> !Check( pk(~skL),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$idCA, $id, pk(~sk), 'pubKey', ~sn.1, $i, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$j.1, \<$idL1, 'SCT', $sct1, SI5\>, $idL2, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'SCT', $sct2, SI4\>\l)\l|<n53> !Check( PK1,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$idCA, $id, pk(~sk), 'pubKey', ~sn.1, $i, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$j.1, \<$idL1, 'SCT', $sct1, SI5\>, $idL2, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'SCT', $sct2, SI4\>\l)\l}}",fillcolor="#f2ce03",style="filled",fontcolor="black",role="Undefined"];
n58[shape="record",label="{{<n55> !Logger( $idL1, pk(~skL) )|<n56> !TLS_L_to_C( $idL1, $idC, $snapshot, ~sthment, ~session )}|{<n57> #t6 : ClientStoresSnapshot[SnapshotStored( $idC, $idL1, ~session, ~sthment ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ClientSnapshotStored( $idC, $idL1, ~session, ~sthment ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.3 )]\l}}",fillcolor="#c6d998",style="filled",fontcolor="black",role="Undefined"];
n62[shape="record",label="{{<n59> !Logger( $idL2, PK1 )|<n60> !TLS_L_to_C( $idL2, $idC, $snapshot.1, ST1, SE1 )}|{<n61> #t7 : ClientStoresSnapshot[SnapshotStored( $idC, $idL2, SE1, ST1 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ClientSnapshotStored( $idC, $idL2, SE1, ST1 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.4 )]\l}}",fillcolor="#c6d998",style="filled",fontcolor="black",role="Undefined"];
n63[label="#vk : coerce[!KU( SI5 )]",shape="ellipse"];
n64[label="#vl : irecv",shape="ellipse"];
n69[shape="record",label="{{<n65> Fr( ~sk )}|{<n66> #vr : Domain_Owner_Init[Time( $now.5 )]}|{<n67> !DomainOwner( $id, pk(~sk) )|<n68> Out( pk(~sk) )}}",fillcolor="#c6c6c6",style="filled",fontcolor="black",role="Undefined"];
n73[shape="record",label="{{<n70> !Logger_s( $idL2, ~skL.1, PK1 )}|{<n71> #t0.1 : Start_Log[StartedLog( $idL2, $log_id.1 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HonestStartedLog( $idL2, $log_id.1 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.6 )]\l}|{<n72> !Log( $idL2, $log_id.1 )}}",fillcolor="#08a358",style="filled",fontcolor="white",role="Undefined"];
n74[label="#vf.1 : isend",shape="ellipse"];
n75[label="#vk.1 : coerce[!KU( SI4 )]",shape="ellipse"];
n76[label="#vl.1 : irecv",shape="ellipse"];
n86[shape="record",label="{{<n77> Fr( ~skCA )|<n78> Fr( ~sn )|<n79> !Root_CA_s0( $rootCA, ~skCA.1, PK2 )}|{<n80> #vr.1 : CA_Init[CA_Registered( $idCA, ~skCA, pk(~skCA) ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NonRoot_CA_Init( $idCA ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DocumentedCA( $rootCA, $idCA, \<$rootCA, $idCA, pk(~skCA), PU1, ~sn, $i0, $j\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $i0 )]\l}|{<n81> Out( \<$rootCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$idCA, pk(~skCA), \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PU1, ~sn, $i0, $j\>\l)\l|<n82> Out( SI2 )|<n83> Out( \<$idCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA)\>\l)\l|<n84> !CA_s0( $idCA, ~skCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, pk(~skCA), \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PU1, ~sn, $i0, $j\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SI2\l)\l|<n85> !CA_Documentation( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$idCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA), PU1, ~sn, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i0, $j\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SI2\l)\l}}",fillcolor="#c871ff",style="filled",fontcolor="black",role="Undefined"];
n87[label="#vf.2 : isend",shape="ellipse"];
n88[label="#vk.2 : coerce[!KU( SI2 )]",shape="ellipse"];
n97[shape="record",label="{{<n89> Fr( ~skCA.1 )|<n90> Fr( ~sn.2 )}|{<n91> #vr.2 : Root_CA_Init[CA_Registered( $rootCA, ~skCA.1, PK2 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root_CA_Init( $rootCA ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.7 )]\l}|{<n92> Out( \<$rootCA, $rootCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PK2, 'selfCert', ~sn.2, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$now.7, $j.2\>\l)\l|<n93> Out( sign(\<$rootCA, $rootCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PK2, 'selfCert', ~sn.2, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$now.7, $j.2\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~skCA.1)\l)\l|<n94> Out( \<$rootCA, PK2\>\l)\l|<n95> !Root_CA_s0( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~skCA.1, PK2\l)\l|<n96> !Root_CA( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PK2\l)\l}}",fillcolor="#620c97",style="filled",fontcolor="white",role="Undefined"];
n98[label="#vf.3 : isend",shape="ellipse"];
n99[label="#vk.3 : coerce[!KU( SI3 )]",shape="ellipse"];
n104[shape="record",label="{{<n100> Fr( ~skL )}|{<n101> #vr.3 : Logger_Init[Logger_Registered( $idL1 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.8 )]\l}|{<n102> !Logger_s( $idL1, ~skL, pk(~skL) )|<n103> !Logger( $idL1, pk(~skL) )}}",fillcolor="#08a358",style="filled",fontcolor="white",role="Undefined"];
n105[label="#vf.4 : isend",shape="ellipse"];
n106[label="#vk.4 : coerce[!KU( ~sn.1 )]",shape="ellipse"];
n107[label="#vl.4 : irecv",shape="ellipse"];
n112[shape="record",label="{{<n108> Fr( ~skL.1 )}|{<n109> #vr.4 : Logger_Init[Logger_Registered( $idL2 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.9 )]\l}|{<n110> !Logger_s( $idL2, ~skL.1, PK1 )|<n111> !Logger( $idL2, PK1 )}}",fillcolor="#08a358",style="filled",fontcolor="white",role="Undefined"];
n113[label="#vf.5 : isend",shape="ellipse"];
n114[label="#vk.5 : coerce[!KU( ~sn )]",shape="ellipse"];
n115[label="#vl.5 : irecv",shape="ellipse"];
n121[shape="record",label="{{<n116> !Logger_s( $idL1, ~skL, pk(~skL) )|<n117> Fr( ~sthment )|<n118> !TLS_C_to_L( $idC, $idL1, ~session )}|{<n119> #vr.5 : LoggerSnapshot_C[LoggerPresentsView( $idL1, $idC, $log_id, $now.10, ~sthment,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~session\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerHandsOutSTH( $idL1, ~sthment, ~session ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.10 )]\l}|{<n120> !TLS_L_to_C( $idL1, $idC, $snapshot, ~sthment, ~session )}}",fillcolor="#22d6d6",style="filled",fontcolor="black",role="Undefined"];
n122[label="#vf.6 : isend",shape="ellipse"];
n123[label="#vk.6 : coerce[!KU( SI1 )]",shape="ellipse"];
n129[shape="record",label="{{<n124> Fr( ~session )|<n125> In( $idC )|<n126> !Logger( $idL1, pk(~skL) )}|{<n127> #vr.6 : ProofFetching_C[FetchLogSnapshot( $idC, $idL1, ~session ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ClientFetchesLogSnapshot( $idC, $idL1, ~session ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.11 )]\l}|{<n128> !TLS_C_to_L( $idC, $idL1, ~session )}}",fillcolor="#10bcc5",style="filled",fontcolor="black",role="Undefined"];
n130[label="#vk.7 : coerce[!KU( pk(~skCA) )]",shape="ellipse"];
n136[shape="record",label="{{<n131> !Logger_s( $idL2, ~skL.1, PK1 )|<n132> Fr( ST1 )|<n133> !TLS_C_to_L( $idC, $idL2, SE1 )}|{<n134> #vr.7 : LoggerSnapshot_C[LoggerPresentsView( $idL2, $idC, $log_id.1, $now.12, ST1, SE1\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerHandsOutSTH( $idL2, ST1, SE1 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.12 )]\l}|{<n135> !TLS_L_to_C( $idL2, $idC, $snapshot.1, ST1, SE1 )}}",fillcolor="#22d6d6",style="filled",fontcolor="black",role="Undefined"];
n137[label="#vk.8 : coerce[!KU( pk(~sk) )]",shape="ellipse"];
n143[shape="record",label="{{<n138> Fr( SE1 )|<n139> In( $idC )|<n140> !Logger( $idL2, PK1 )}|{<n141> #vr.8 : ProofFetching_C[FetchLogSnapshot( $idC, $idL2, SE1 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ClientFetchesLogSnapshot( $idC, $idL2, SE1 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.13 )]\l}|{<n142> !TLS_C_to_L( $idC, $idL2, SE1 )}}",fillcolor="#10bcc5",style="filled",fontcolor="black",role="Undefined"];
n144[label="#vr.9 : d_0_snd",shape="ellipse"];
n145[label="#vr.10 : d_0_snd",shape="ellipse"];
n146[label="#vr.11 : d_0_snd",shape="ellipse"];
n147[label="#vr.12 : d_0_snd",shape="ellipse"];
n148[label="#vr.13 : d_0_snd",shape="ellipse"];
n149[label="#vf.14 : isend",shape="ellipse"];
n150[label="#vr.14 : d_0_snd",shape="ellipse"];
n151[label="#vf.15 : isend",shape="ellipse"];
n152[label="#vr.15 : d_0_snd",shape="ellipse"];
n153[label="#vf.16 : isend",shape="ellipse"];
n154[label="#vr.16 : d_0_snd",shape="ellipse"];
n155[label="#vf.17 : isend",shape="ellipse"];
n156[label="#vr.17 : d_0_snd",shape="ellipse"];
n157[label="#vf.18 : isend",shape="ellipse"];
n158[label="#vr.18 : d_0_snd",shape="ellipse"];
n159[label="#vf.19 : isend",shape="ellipse"];
n160[label="#vf.20 : isend",shape="ellipse"];
n161[label="#vr.20 : d_0_snd",shape="ellipse"];
n162[label="#vf.21 : isend",shape="ellipse"];
n163[label="#vr.21 : d_0_snd",shape="ellipse"];
n164[label="#vr.22 : d_0_snd",shape="ellipse"];
n165[label="#vr.23 : d_0_snd",shape="ellipse"];
n166[label="#vf.24 : isend",shape="ellipse"];
n167[label="#vf.27 : isend",shape="ellipse"];
n3:n2 -> n23:n20[style="bold",weight="10.0",color="gray50"];
n13:n8 -> n107[color="gray30"];
n13:n9 -> n99[color="orangered2"];
n13:n10 -> n43:n39[style="bold",weight="10.0"];
n23:n22 -> n64[color="gray30"];
n33:n32 -> n76[color="gray30"];
n43:n42 -> n123[color="orangered2"];
n64 -> n144[color="orangered2"];
n69:n67 -> n13:n4[style="bold",weight="10.0",color="gray50"];
n69:n68 -> n137[color="orangered2"];
n73:n72 -> n33:n30[style="bold",weight="10.0",color="gray50"];
n74 -> n43:n35[color="gray30"];
n76 -> n147[color="orangered2"];
n86:n81 -> n115[color="gray30"];
n86:n82 -> n88[color="orangered2"];
n86:n84 -> n13:n5[style="bold",weight="10.0",color="gray50"];
n86:n84 -> n43:n34[style="bold",weight="10.0",color="gray50"];
n87 -> n43:n36[color="gray30"];
n97:n95 -> n86:n79[style="bold",weight="10.0",color="gray50"];
n97:n96 -> n23:n19[style="bold",weight="10.0",color="gray50"];
n97:n96 -> n33:n29[style="bold",weight="10.0",color="gray50"];
n97:n96 -> n54:n44[style="bold",weight="10.0",color="gray50"];
n98 -> n54:n45[color="gray30"];
n104:n102 -> n3:n0[style="bold",weight="10.0",color="gray50"];
n104:n102 -> n23:n18[style="bold",weight="10.0",color="gray50"];
n104:n102 -> n121:n116[style="bold",weight="10.0",color="gray50"];
n104:n103 -> n43:n37[style="bold",weight="10.0",color="gray50"];
n104:n103 -> n54:n49[style="bold",weight="10.0",color="gray50"];
n104:n103 -> n58:n55[style="bold",weight="10.0",color="gray50"];
n104:n103 -> n129:n126[style="bold",weight="10.0",color="gray50"];
n105 -> n54:n46[color="gray30"];
n107 -> n152[color="orangered2"];
n112:n110 -> n33:n28[style="bold",weight="10.0",color="gray50"];
n112:n110 -> n73:n70[style="bold",weight="10.0",color="gray50"];
n112:n110 -> n136:n131[style="bold",weight="10.0",color="gray50"];
n112:n111 -> n43:n38[style="bold",weight="10.0",color="gray50"];
n112:n111 -> n54:n50[style="bold",weight="10.0",color="gray50"];
n112:n111 -> n62:n59[style="bold",weight="10.0",color="gray50"];
n112:n111 -> n143:n140[style="bold",weight="10.0",color="gray50"];
n113 -> n54:n47[color="gray30"];
n115 -> n161[color="orangered2"];
n121:n120 -> n58:n56[style="bold",weight="10.0",color="gray50"];
n122 -> n54:n48[color="gray30"];
n129:n128 -> n121:n118[style="bold",weight="10.0",color="gray50"];
n136:n135 -> n62:n60[style="bold",weight="10.0",color="gray50"];
n143:n142 -> n136:n133[style="bold",weight="10.0",color="gray50"];
n144 -> n145[color="orangered2"];
n145 -> n146[color="orangered2"];
n146 -> n63[color="orangered2"];
n147 -> n148[color="orangered2"];
n148 -> n150[color="orangered2"];
n149 -> n23:n14[color="gray30"];
n150 -> n75[color="orangered2"];
n151 -> n23:n15[color="gray30"];
n152 -> n154[color="orangered2"];
n153 -> n23:n16[color="gray30"];
n154 -> n156[color="orangered2"];
n155 -> n23:n17[color="gray30"];
n156 -> n158[color="orangered2"];
n157 -> n33:n24[color="gray30"];
n158 -> n106[color="orangered2"];
n159 -> n33:n25[color="gray30"];
n160 -> n33:n26[color="gray30"];
n161 -> n163[color="orangered2"];
n162 -> n33:n27[color="gray30"];
n163 -> n130[color="orangered2"];
n163 -> n164[color="orangered2"];
n164 -> n165[color="orangered2"];
n165 -> n114[color="orangered2"];
n166 -> n129:n125[color="gray30"];
n167 -> n143:n139[color="gray30"];
n3:n1 -> n121:n119[color="black",style="dashed"];
n23:n21 -> n33:n31[color="black",style="dashed"];
n33:n31 -> n43:n40[color="black",style="dashed"];
n43:n40 -> n54:n51[color="black",style="dashed"];
n54:n51 -> n58:n57[color="black",style="dashed"];
n58:n57 -> n62:n61[color="black",style="dashed"];
n63 -> n74[color="red",style="dashed"];
n63 -> n113[color="red",style="dashed"];
n64 -> n74[color="red",style="dashed"];
n64 -> n113[color="red",style="dashed"];
n73:n71 -> n136:n134[color="black",style="dashed"];
n75 -> n87[color="red",style="dashed"];
n75 -> n113[color="red",style="dashed"];
n76 -> n87[color="red",style="dashed"];
n76 -> n113[color="red",style="dashed"];
n88 -> n105[color="red",style="dashed"];
n88 -> n155[color="red",style="dashed"];
n88 -> n162[color="red",style="dashed"];
n99 -> n151[color="red",style="dashed"];
n99 -> n159[color="red",style="dashed"];
n106 -> n113[color="red",style="dashed"];
n106 -> n149[color="red",style="dashed"];
n106 -> n157[color="red",style="dashed"];
n107 -> n149[color="red",style="dashed"];
n107 -> n157[color="red",style="dashed"];
n114 -> n98[color="red",style="dashed"];
n114 -> n153[color="red",style="dashed"];
n114 -> n160[color="red",style="dashed"];
n115 -> n98[color="red",style="dashed"];
n115 -> n153[color="red",style="dashed"];
n115 -> n160[color="red",style="dashed"];
n123 -> n122[color="red",style="dashed"];
n130 -> n98[color="red",style="dashed"];
n130 -> n153[color="red",style="dashed"];
n130 -> n160[color="red",style="dashed"];
n137 -> n113[color="red",style="dashed"];
n137 -> n149[color="red",style="dashed"];
n137 -> n157[color="red",style="dashed"];
n144 -> n74[color="red",style="dashed"];
n144 -> n113[color="red",style="dashed"];
n145 -> n74[color="red",style="dashed"];
n145 -> n113[color="red",style="dashed"];
n147 -> n87[color="red",style="dashed"];
n147 -> n113[color="red",style="dashed"];
n148 -> n87[color="red",style="dashed"];
n148 -> n113[color="red",style="dashed"];
n152 -> n149[color="red",style="dashed"];
n152 -> n157[color="red",style="dashed"];
n154 -> n149[color="red",style="dashed"];
n154 -> n157[color="red",style="dashed"];
n156 -> n149[color="red",style="dashed"];
n156 -> n157[color="red",style="dashed"];
n158 -> n149[color="red",style="dashed"];
n158 -> n157[color="red",style="dashed"];
n161 -> n98[color="red",style="dashed"];
n161 -> n153[color="red",style="dashed"];
n161 -> n160[color="red",style="dashed"];
n163 -> n98[color="red",style="dashed"];
n163 -> n153[color="red",style="dashed"];
n163 -> n160[color="red",style="dashed"];
n164 -> n98[color="red",style="dashed"];
n164 -> n153[color="red",style="dashed"];
n164 -> n160[color="red",style="dashed"];
n165 -> n98[color="red",style="dashed"];
n165 -> n153[color="red",style="dashed"];
n165 -> n160[color="red",style="dashed"];
{
rank="sink";
n168[shape="plain",label=<<TABLE BORDER="1" CELLBORDER="0" CELLSPACING="3" CELLPADDING="1"><TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">PK1</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">pk(~skL.1)</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">PK2</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">pk(~skCA.1)</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">PU1</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">'pubKey-CA'</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">SE1</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">~session.1</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">SI2</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">sign(&lt;$rootCA, $idCA, pk(~skCA), PU1, ~sn, $i0, $j&gt;, ~skCA.1)</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">SI3</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">sign(&lt;$idCA, $id, pk(~sk), 'pre-cert', ~sn.1, $i, $j.1&gt;, ~skCA)</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">SI4</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">sign(&lt;$idL2, 'SCT', $sct2, $idCA, $id, pk(~sk), ~sn.1, $i, $j.1&gt;,<BR ALIGN="LEFT"/> &#32;&#32;&#32;&#32;~skL.1)</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">SI5</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">sign(&lt;$idL1, 'SCT', $sct1, $idCA, $id, pk(~sk), ~sn.1, $i, $j.1&gt;,<BR ALIGN="LEFT"/> &#32;&#32;&#32;&#32;~skL)</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">SI1</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">sign(&lt;$idCA, $id, pk(~sk), 'pubKey', ~sn.1, $i, $j.1, <BR ALIGN="LEFT"/> &#32;&#32;&#32;&#32;&#32;&lt;$idL1, 'SCT', $sct1, SI5&gt;, $idL2, 'SCT', $sct2, SI4&gt;,<BR ALIGN="LEFT"/> &#32;&#32;&#32;&#32;~skCA)</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">ST1</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">~sthment.1</TD></TR></TABLE>>];

}
n62:n61 -> n168[style="invis"];

}
