digraph "trace_ct_SL2-AS0-CL0-A1-C1-NB_san_CT_monitorFindsRogueCertificate-monitorFindsRogueCertificate-StartMonitoring-monitorTrackSubject-LoggerSnapshot_M-Root_CA_Init-monitorFindsRogueCertificate-monitorFindsRogueCertificate-LoggerSnapshot_M-add_preC_to_log-Logger_Init-Root_CA_Init-Start_Log-Start_Log-CA_Init-c_sign-compromiseCA-CA_Init-CA_Init_case_1" {
nodesep="0.3";
ranksep="0.3";
node[fontsize="8",fontname="Helvetica",width="0.3",height="0.2"];
edge[fontsize="8",fontname="Helvetica"];
n9[shape="record",label="{{<n0> In( \<$idCA, $subj, ke, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'pre-cert', sn, $i, $j\>\l)\l|<n1> In( SI2 )|<n2> In( \<$rootCA, $idCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA), PU1, ~sn.1, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i0, $j0\>\l)\l|<n3> In( SI1 )|<n4> !Logger_s( $idL,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~skL, pk(~skL)\l)\l|<n5> !Root_CA( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PK1\l)\l|<n6> !Log( $idL, $log_id\l)\l}|{<n7> #t : add_preC_to_log[Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerComputesAddLogStmt( $idL, $log_id, \<$idCA, $subj, ke, sn\>, $now ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerComputesAddLog( $idL, $log_id, \<$idCA, $subj, ke, 'pre-cert', sn, $i, $j\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<\<\<$idCA, $subj, ke, 'pre-cert', sn, $i, $j\>, SI2\>, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, pk(~skCA), PU1, ~sn.1, $i0, $j0\>, SI1\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$now\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerAsserts( $idL,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$idL, 'SCT', $now, sign(\<$idL, 'SCT', $now, $idCA, $subj, ke, sn, $i, $j\>, ~skL)\>\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckIssuedTime( $now, $i ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckValidUntil( $now, $j )]\l}|{<n8> Out( \<$idL, 'SCT', $now, sign(\<$idL, 'SCT', $now, $idCA, $subj, ke, sn, $i, $j\>, ~skL)\>\l)\l}}",fillcolor="#08a358",style="filled",fontcolor="white",role="Undefined"];
n13[shape="record",label="{{<n10> !Logger_s( $idL, ~skL, pk(~skL) )}|{<n11> #t0 : Start_Log[StartedLog( $idL, $log_id ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HonestStartedLog( $idL, $log_id ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.1 )]\l}|{<n12> !Log( $idL, $log_id )}}",fillcolor="#08a358",style="filled",fontcolor="white",role="Undefined"];
n23[shape="record",label="{{<n14> !LoggerDict( $idM,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$idL\l)\l|<n15> !TrackSubject( $idM,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$idServer\l)\l|<n16> In( \<$idCA, $subj, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ke, 'pre-cert', sn, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i, $j\>\l)\l|<n17> In( SI2 )|<n18> In( \<$rootCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$idCA, pk(~skCA), \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PU1, ~sn.1, $i0, $j0\l&nbsp;&nbsp;&nbsp;&nbsp;\>\l)\l|<n19> In( SI1 )|<n20> !TLS_L_to_M( $idL,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$idM, $snapshot,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~sthment,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~session\l)\l|<n21> !Root_CA( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PK1\l)\l}|{<n22> #t1 : monitorFindsRogueCertificate[Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MonitorFindsCert( $idM, $idL, \<$idCA, $subj, ke, sn\>, ~sthment, ~session ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MonitorBlamesCA( $idCA, $idL, \<$idCA, $subj, ke, sn\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, pk(~skCA), PU1, ~sn.1, $i0, $j0\>, ~sthment, ~session\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MonitorObservesEntry( $idM, $idL,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<\<\<$idCA, $subj, ke, 'pre-cert', sn, $i, $j\>, SI2\>, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, pk(~skCA), PU1, ~sn.1, $i0, $j0\>, SI1\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~sthment, ~session\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RogueCert( $idCA, \<$idCA, $subj, ke, sn\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MonitorInspectsLog( $idM, $idL, \<$idCA, $subj, ke, sn\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, pk(~skCA), PU1, ~sn.1, $i0, $j0\>, ~sthment, ~session\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MonitorInspectsLog_noTrust( $idL, \<$idCA, $subj, ke, sn\>, ~sthment, ~session ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Revoked( \<$idCA, $subj, ke, sn\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.2 )]\l}}",fillcolor="#f3d664",style="filled",fontcolor="black",role="Undefined"];
n29[shape="record",label="{{<n24> !Logger_s( $idL, ~skL, pk(~skL) )|<n25> Fr( ~sthment )|<n26> !TLS_M_to_L( $idM, $idL, ~session )}|{<n27> #t2 : LoggerSnapshot_M[LoggerPresentsView( $idL, $idM, $log_id, $now.3, ~sthment,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~session\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerHandsOutSTH( $idL, ~sthment, ~session ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.3 )]\l}|{<n28> !TLS_L_to_M( $idL, $idM, $snapshot, ~sthment, ~session )}}",fillcolor="#22d6d6",style="filled",fontcolor="black",role="Undefined"];
n30[label="#vf : isend",shape="ellipse"];
n31[label="#vk : coerce[!KU( SI1 )]",shape="ellipse"];
n36[shape="record",label="{{<n32> !Monitor( $idM )|<n33> !Logger( $idL, pk(~skL) )}|{<n34> #vr : StartMonitoring[Time( $now.4 )]}|{<n35> !LoggerDict( $idM, $idL )}}",fillcolor="#ffdc4e",style="filled",fontcolor="black",role="Undefined"];
n37[label="#vf.1 : isend",shape="ellipse"];
n38[label="#vk.1 : c_sign[!KU( SI2 )]",shape="ellipse"];
n41[shape="record",label="{{<n39> #vr.1 : Monitor_Init[Monitor_Registered( $idM ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.5 )]\l}|{<n40> !Monitor( $idM )}}",fillcolor="#abdc9a",style="filled",fontcolor="black",role="Undefined"];
n42[label="#vf.2 : isend",shape="ellipse"];
n43[label="#vk.2 : coerce[!KU( ~skCA )]",shape="ellipse"];
n44[label="#vl.2 : irecv",shape="ellipse"];
n49[shape="record",label="{{<n45> Fr( ~skL )}|{<n46> #vr.2 : Logger_Init[Logger_Registered( $idL ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.6 )]\l}|{<n47> !Logger_s( $idL, ~skL, pk(~skL) )|<n48> !Logger( $idL, pk(~skL) )}}",fillcolor="#08a358",style="filled",fontcolor="white",role="Undefined"];
n50[label="#vf.3 : isend",shape="ellipse"];
n51[label="#vk.3 : coerce[!KU( ~sn.1 )]",shape="ellipse"];
n56[shape="record",label="{{<n52> !Monitor( $idM )|<n53> !DomainOwner( $idServer, pk(~sk) )}|{<n54> #vr.3 : monitorTrackSubject[Time( $now.7 )]}|{<n55> !TrackSubject( $idM, $idServer )}}",fillcolor="#fac800",style="filled",fontcolor="black",role="Undefined"];
n57[label="#vk.4 : coerce[!KU( pk(~skCA) )]",shape="ellipse"];
n60[shape="record",label="{{<n58> #vr.4 : Monitor_Init[Monitor_Registered( $idM ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.8 )]\l}|{<n59> !Monitor( $idM )}}",fillcolor="#abdc9a",style="filled",fontcolor="black",role="Undefined"];
n65[shape="record",label="{{<n61> Fr( ~sk )}|{<n62> #vr.5 : Domain_Owner_Init[Time( $now.9 )]}|{<n63> !DomainOwner( $idServer, pk(~sk) )|<n64> Out( pk(~sk) )}}",fillcolor="#c6c6c6",style="filled",fontcolor="black",role="Undefined"];
n71[shape="record",label="{{<n66> Fr( ~session )|<n67> !Monitor( $idM )|<n68> !Logger( $idL, pk(~skL) )}|{<n69> #vr.6 : ProofFetching_M[FetchLogSnapshot( $idM, $idL, ~session ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MonitorFetchesLogSnapshot( $idM, $idL, ~session ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.10 )]\l}|{<n70> !TLS_M_to_L( $idM, $idL, ~session )}}",fillcolor="#10bcc5",style="filled",fontcolor="black",role="Undefined"];
n74[shape="record",label="{{<n72> #vr.7 : Monitor_Init[Monitor_Registered( $idM ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.11 )]\l}|{<n73> !Monitor( $idM )}}",fillcolor="#abdc9a",style="filled",fontcolor="black",role="Undefined"];
n83[shape="record",label="{{<n75> Fr( ~skCA.1 )|<n76> Fr( ~sn.2 )}|{<n77> #vr.8 : Root_CA_Init[CA_Registered( $rootCA, ~skCA.1, PK1 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root_CA_Init( $rootCA ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.12 )]\l}|{<n78> Out( \<$rootCA, $rootCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PK1, 'selfCert', ~sn.2, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$now.12, $j.1\>\l)\l|<n79> Out( sign(\<$rootCA, $rootCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PK1, 'selfCert', ~sn.2, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$now.12, $j.1\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~skCA.1)\l)\l|<n80> Out( \<$rootCA, PK1\>\l)\l|<n81> !Root_CA_s0( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~skCA.1, PK1\l)\l|<n82> !Root_CA( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PK1\l)\l}}",fillcolor="#620c97",style="filled",fontcolor="white",role="Undefined"];
n93[shape="record",label="{{<n84> Fr( ~skCA )|<n85> Fr( ~sn.1 )|<n86> !Root_CA_s0( $rootCA, ~skCA.1, PK1 )}|{<n87> #vr.9 : CA_Init[CA_Registered( $idCA, ~skCA, pk(~skCA) ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NonRoot_CA_Init( $idCA ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DocumentedCA( $rootCA, $idCA, \<$rootCA, $idCA, pk(~skCA), PU1, ~sn.1, $i0, $j0\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $i0 )]\l}|{<n88> Out( \<$rootCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$idCA, pk(~skCA), \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PU1, ~sn.1, $i0, $j0\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\>\l)\l|<n89> Out( SI1 )|<n90> Out( \<$idCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA)\>\l)\l|<n91> !CA_s0( $idCA, ~skCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, pk(~skCA), \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PU1, ~sn.1, $i0, $j0\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SI1\l)\l|<n92> !CA_Documentation( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$idCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA), PU1, ~sn.1, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i0, $j0\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SI1\l)\l}}",fillcolor="#c871ff",style="filled",fontcolor="black",role="Undefined"];
n94[label="#vf.10 : isend",shape="ellipse"];
n98[shape="record",label="{{<n95> !CA_s0( $idCA, ~skCA, pk(~skCA), \<$rootCA, $idCA, pk(~skCA), PU1, ~sn.1, $i0, $j0\>, SI1\l)\l}|{<n96> #vr.10 : compromiseCA[CompromiseCA( $idCA ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Compromise( ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Corrupted( $idCA ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.13 )]\l}|{<n97> Out( ~skCA )}}",fillcolor="#d40808",style="filled",fontcolor="white",role="Undefined"];
n99[label="#vf.11 : isend",shape="ellipse"];
n100[label="#vr.11 : d_0_snd",shape="ellipse"];
n101[label="#vf.12 : isend",shape="ellipse"];
n102[label="#vr.12 : d_0_snd",shape="ellipse"];
n103[label="#vf.13 : isend",shape="ellipse"];
n104[label="#vr.13 : d_0_snd",shape="ellipse"];
n105[label="#vr.14 : d_0_snd",shape="ellipse"];
n106[label="!KU( ke ) @ #vk.13",shape="ellipse",color="gray"];
n107[label="!KU( sn ) @ #vk.19",shape="ellipse",color="gray"];
n13:n12 -> n9:n6[style="bold",weight="10.0",color="gray50"];
n29:n28 -> n23:n20[style="bold",weight="10.0",color="gray50"];
n30 -> n23:n16[color="gray30"];
n36:n35 -> n23:n14[style="bold",weight="10.0",color="gray50"];
n37 -> n23:n17[color="gray30"];
n41:n40 -> n36:n32[style="bold",weight="10.0",color="gray50"];
n42 -> n23:n18[color="gray30"];
n44 -> n100[color="orangered2"];
n49:n47 -> n9:n4[style="bold",weight="10.0",color="gray50"];
n49:n47 -> n13:n10[style="bold",weight="10.0",color="gray50"];
n49:n47 -> n29:n24[style="bold",weight="10.0",color="gray50"];
n49:n48 -> n36:n33[style="bold",weight="10.0",color="gray50"];
n49:n48 -> n71:n68[style="bold",weight="10.0",color="gray50"];
n50 -> n23:n19[color="gray30"];
n56:n55 -> n23:n15[style="bold",weight="10.0",color="gray50"];
n60:n59 -> n56:n52[style="bold",weight="10.0",color="gray50"];
n65:n63 -> n56:n53[style="bold",weight="10.0",color="gray50"];
n71:n70 -> n29:n26[style="bold",weight="10.0",color="gray50"];
n74:n73 -> n71:n67[style="bold",weight="10.0",color="gray50"];
n83:n81 -> n93:n86[style="bold",weight="10.0",color="gray50"];
n83:n82 -> n9:n5[style="bold",weight="10.0",color="gray50"];
n83:n82 -> n23:n21[style="bold",weight="10.0",color="gray50"];
n93:n88 -> n44[color="gray30"];
n93:n89 -> n31[color="orangered2"];
n93:n91 -> n98:n95[style="bold",weight="10.0",color="gray50"];
n94 -> n9:n0[color="gray30"];
n98:n97 -> n43[color="orangered2"];
n99 -> n9:n1[color="gray30"];
n100 -> n102[color="orangered2"];
n101 -> n9:n2[color="gray30"];
n102 -> n57[color="orangered2"];
n102 -> n104[color="orangered2"];
n103 -> n9:n3[color="gray30"];
n104 -> n105[color="orangered2"];
n105 -> n51[color="orangered2"];
n9:n7 -> n29:n27[color="black",style="dashed"];
n13:n11 -> n29:n27[color="black",style="dashed"];
n31 -> n50[color="red",style="dashed"];
n31 -> n103[color="red",style="dashed"];
n38 -> n37[color="red",style="dashed"];
n38 -> n99[color="red",style="dashed"];
n43 -> n38[color="red",style="dashed"];
n44 -> n42[color="red",style="dashed"];
n44 -> n101[color="red",style="dashed"];
n51 -> n42[color="red",style="dashed"];
n51 -> n101[color="red",style="dashed"];
n57 -> n42[color="red",style="dashed"];
n57 -> n101[color="red",style="dashed"];
n100 -> n42[color="red",style="dashed"];
n100 -> n101[color="red",style="dashed"];
n102 -> n42[color="red",style="dashed"];
n102 -> n101[color="red",style="dashed"];
n106 -> n30[color="red",style="dashed"];
n106 -> n38[color="red",style="dashed"];
n106 -> n94[color="red",style="dashed"];
n104 -> n42[color="red",style="dashed"];
n104 -> n101[color="red",style="dashed"];
n105 -> n42[color="red",style="dashed"];
n105 -> n101[color="red",style="dashed"];
n107 -> n30[color="red",style="dashed"];
n107 -> n38[color="red",style="dashed"];
n107 -> n94[color="red",style="dashed"];
{
rank="sink";
n108[shape="plain",label=<<TABLE BORDER="1" CELLBORDER="0" CELLSPACING="3" CELLPADDING="1"><TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">PK1</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">pk(~skCA.1)</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">PU1</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">'pubKey-CA'</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">SI1</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">sign(&lt;$rootCA, $idCA, pk(~skCA), PU1, ~sn.1, $i0, $j0&gt;, ~skCA.1)</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">SI2</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">sign(&lt;$idCA, $subj, ke, 'pre-cert', sn, $i, $j&gt;, ~skCA)</TD></TR></TABLE>>];

}
n23:n22 -> n108[style="invis"];

}
