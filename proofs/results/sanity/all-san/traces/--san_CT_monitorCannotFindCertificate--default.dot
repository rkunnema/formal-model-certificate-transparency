digraph "trace_ct_SL2-AS0-CL0-A1-C1-NB_san_CT_monitorCannotFindCertificate-case_1-StartMonitoring-monitorTrackSubject-LoggerSnapshot_M-Root_CA_Init-LoggerSnapshot_M-Start_Log-Logger_Init" {
nodesep="0.3";
ranksep="0.3";
node[fontsize="8",fontname="Helvetica",width="0.3",height="0.2"];
edge[fontsize="8",fontname="Helvetica"];
n9[shape="record",label="{{<n0> !LoggerDict( $idM,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$idL\l)\l|<n1> !TrackSubject( $idM,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$idServer\l)\l|<n2> In( \<$idCA, $subj, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ke, 'pre-cert', sn, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i, $j\>\l)\l|<n3> In( cert_sig )|<n4> In( \<$rootCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$idCA, pkCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'pubKey-CA', snCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i0, $j0\>\l)\l|<n5> In( ca_sig )|<n6> !TLS_L_to_M( $idL,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$idM, $snapshot,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~sthment,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~session\l)\l|<n7> !Root_CA( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA)\l)\l}|{<n8> #t : monitorCannotFindCertificate[CannotFindCert( $idM, \<$idCA, $subj, ke, sn\>, $idL,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~sthment, ~session\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MonitorCannotFind( $idM, $idL, \<$idCA, $subj, ke, sn\>, ~sthment, ~session ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NothingObserved( $idM, $idL, \<$idCA, $subj, ke, 'pre-cert', sn, $i, $j\>, ~sthment,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~session\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MonitorInspectsLog_noTrust( $idL, \<$idCA, $subj, ke, sn\>, ~sthment, ~session ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MonitorInspectsLog( $idM, $idL, \<$idCA, $subj, ke, sn\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, pkCA, 'pubKey-CA', snCA, $i0, $j0\>, ~sthment, ~session\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Debug3( )]\l}}",fillcolor="#f3d664",style="filled",fontcolor="black",role="Undefined"];
n15[shape="record",label="{{<n10> !Logger_s( $idL, ~skL, pk(~skL) )|<n11> Fr( ~sthment )|<n12> !TLS_M_to_L( $idM, $idL, ~session )}|{<n13> #t0 : LoggerSnapshot_M[LoggerPresentsView( $idL, $idM, $log_id, $now.1, ~sthment,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~session\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerHandsOutSTH( $idL, ~sthment, ~session ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.1 )]\l}|{<n14> !TLS_L_to_M( $idL, $idM, $snapshot, ~sthment, ~session )}}",fillcolor="#22d6d6",style="filled",fontcolor="black",role="Undefined"];
n16[label="#vf : isend",shape="ellipse"];
n21[shape="record",label="{{<n17> !Monitor( $idM )|<n18> !Logger( $idL, pk(~skL) )}|{<n19> #vr : StartMonitoring[Time( $now.2 )]}|{<n20> !LoggerDict( $idM, $idL )}}",fillcolor="#ffdc4e",style="filled",fontcolor="black",role="Undefined"];
n25[shape="record",label="{{<n22> !Logger_s( $idL, ~skL, pk(~skL) )}|{<n23> #t0.1 : Start_Log[StartedLog( $idL, $log_id ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HonestStartedLog( $idL, $log_id ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.3 )]\l}|{<n24> !Log( $idL, $log_id )}}",fillcolor="#08a358",style="filled",fontcolor="white",role="Undefined"];
n26[label="#vf.1 : isend",shape="ellipse"];
n29[shape="record",label="{{<n27> #vr.1 : Monitor_Init[Monitor_Registered( $idM ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.4 )]\l}|{<n28> !Monitor( $idM )}}",fillcolor="#a7dd9a",style="filled",fontcolor="black",role="Undefined"];
n30[label="#vf.2 : isend",shape="ellipse"];
n35[shape="record",label="{{<n31> Fr( ~skL )}|{<n32> #vr.2 : Logger_Init[Logger_Registered( $idL ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.5 )]\l}|{<n33> !Logger_s( $idL, ~skL, pk(~skL) )|<n34> !Logger( $idL, pk(~skL) )}}",fillcolor="#08a358",style="filled",fontcolor="white",role="Undefined"];
n36[label="#vf.3 : isend",shape="ellipse"];
n41[shape="record",label="{{<n37> !Monitor( $idM )|<n38> !DomainOwner( $idServer, pk(~sk) )}|{<n39> #vr.3 : monitorTrackSubject[Time( $now.6 )]}|{<n40> !TrackSubject( $idM, $idServer )}}",fillcolor="#fac800",style="filled",fontcolor="black",role="Undefined"];
n44[shape="record",label="{{<n42> #vr.4 : Monitor_Init[Monitor_Registered( $idM ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.7 )]\l}|{<n43> !Monitor( $idM )}}",fillcolor="#a7dd9a",style="filled",fontcolor="black",role="Undefined"];
n49[shape="record",label="{{<n45> Fr( ~sk )}|{<n46> #vr.5 : Domain_Owner_Init[Time( $now.8 )]}|{<n47> !DomainOwner( $idServer, pk(~sk) )|<n48> Out( pk(~sk) )}}",fillcolor="#c6c6c6",style="filled",fontcolor="black",role="Undefined"];
n55[shape="record",label="{{<n50> Fr( ~session )|<n51> !Monitor( $idM )|<n52> !Logger( $idL, pk(~skL) )}|{<n53> #vr.6 : ProofFetching_M[FetchLogSnapshot( $idM, $idL, ~session ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MonitorFetchesLogSnapshot( $idM, $idL, ~session ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.9 )]\l}|{<n54> !TLS_M_to_L( $idM, $idL, ~session )}}",fillcolor="#10bcc5",style="filled",fontcolor="black",role="Undefined"];
n58[shape="record",label="{{<n56> #vr.7 : Monitor_Init[Monitor_Registered( $idM ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.10 )]\l}|{<n57> !Monitor( $idM )}}",fillcolor="#a7dd9a",style="filled",fontcolor="black",role="Undefined"];
n67[shape="record",label="{{<n59> Fr( ~skCA )|<n60> Fr( ~sn.1 )}|{<n61> #vr.8 : Root_CA_Init[CA_Registered( $rootCA, ~skCA, pk(~skCA) ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root_CA_Init( $rootCA ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.11 )]\l}|{<n62> Out( \<$rootCA, $rootCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA), 'selfCert', \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~sn.1, $now.11, $j.1\>\l)\l|<n63> Out( sign(\<$rootCA, $rootCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA), 'selfCert', \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~sn.1, $now.11, $j.1\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~skCA)\l)\l|<n64> Out( \<$rootCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA)\>\l)\l|<n65> !Root_CA_s0( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~skCA, pk(~skCA)\l)\l|<n66> !Root_CA( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA)\l)\l}}",fillcolor="#620c97",style="filled",fontcolor="white",role="Undefined"];
n68[label="!KU( ke ) @ #vk.7",shape="ellipse",color="gray"];
n69[label="!KU( sn ) @ #vk.11",shape="ellipse",color="gray"];
n70[label="!KU( cert_sig ) @ #vk.15",shape="ellipse",color="gray"];
n71[label="!KU( pkCA ) @ #vk.18",shape="ellipse",color="gray"];
n72[label="!KU( snCA ) @ #vk.22",shape="ellipse",color="gray"];
n73[label="!KU( ca_sig ) @ #vk.26",shape="ellipse",color="gray"];
n15:n14 -> n9:n6[style="bold",weight="10.0",color="gray50"];
n16 -> n9:n2[color="gray30"];
n21:n20 -> n9:n0[style="bold",weight="10.0",color="gray50"];
n26 -> n9:n3[color="gray30"];
n29:n28 -> n21:n17[style="bold",weight="10.0",color="gray50"];
n30 -> n9:n4[color="gray30"];
n35:n33 -> n15:n10[style="bold",weight="10.0",color="gray50"];
n35:n33 -> n25:n22[style="bold",weight="10.0",color="gray50"];
n35:n34 -> n21:n18[style="bold",weight="10.0",color="gray50"];
n35:n34 -> n55:n52[style="bold",weight="10.0",color="gray50"];
n36 -> n9:n5[color="gray30"];
n41:n40 -> n9:n1[style="bold",weight="10.0",color="gray50"];
n44:n43 -> n41:n37[style="bold",weight="10.0",color="gray50"];
n49:n47 -> n41:n38[style="bold",weight="10.0",color="gray50"];
n55:n54 -> n15:n12[style="bold",weight="10.0",color="gray50"];
n58:n57 -> n55:n51[style="bold",weight="10.0",color="gray50"];
n67:n66 -> n9:n7[style="bold",weight="10.0",color="gray50"];
n25:n23 -> n15:n13[color="black",style="dashed"];
n68 -> n16[color="red",style="dashed"];
n69 -> n16[color="red",style="dashed"];
n70 -> n26[color="red",style="dashed"];
n71 -> n30[color="red",style="dashed"];
n72 -> n30[color="red",style="dashed"];
n73 -> n36[color="red",style="dashed"];

}
