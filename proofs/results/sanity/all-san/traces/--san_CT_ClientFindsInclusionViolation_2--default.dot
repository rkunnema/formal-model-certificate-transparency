digraph "trace_ct_SL2-AS0-CL0-A1-C1-NB_san_CT_ClientFindsInclusionViolation_2-case_1-Root_CA_Init-Logger_Init-Logger_Init-LoggerSnapshot_C-Logger_Init-ClientValidate_case_1-ProofFetching_C-LoggerSnapshot_C-Start_Log-Logger_Init-LoggerSnapshot_C-CA_Init-c_sign-compromiseLogger-add_preC_to_log-PubKeyCertify-PreCertify-CA_Init-CA_Init-PreCertify-CA_Init_case_1-Domain_Owner_Init" {
nodesep="0.3";
ranksep="0.3";
node[fontsize="8",fontname="Helvetica",width="0.3",height="0.2"];
edge[fontsize="8",fontname="Helvetica"];
n3[shape="record",label="{{<n0> !Logger_s( $idL, ~skL, pk(~skL) )}|{<n1> #t0 : Start_Log[StartedLog( $idL, $log_id ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HonestStartedLog( $idL, $log_id ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now )]\l}|{<n2> !Log( $idL, $log_id )}}",fillcolor="#08a358",style="filled",fontcolor="white",role="Undefined"];
n14[shape="record",label="{{<n4> !Root_CA( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA)\l)\l|<n5> In( \<$rootCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$idCA, PK1, PU1, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~sn, $i0, $j0\>\l)\l|<n6> In( SI2 )|<n7> In( \<$idCA, $id, pk(~sk), 'pubKey', \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~sn.1, $i, $j, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$idL, 'SCT', $sct1, SI5\>, $idL2, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'SCT', $sct2, SI4\>\l)\l|<n8> In( SI1 )|<n9> !Logger( $idL,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skL)\l)\l|<n10> !Logger( $idL2, PK2\l)\l}|{<n11> #t1 : ClientValidate[ClientAcceptsChain( $idL, $idL2, $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, PK1, PU1, ~sn, $i0, $j0\>, $idCA, \<$idCA, $id, pk(~sk), ~sn.1\>\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ClientAcceptsCert( $idL, $idL2, \<$idCA, $id, pk(~sk), PR1, ~sn.1, $i, $j\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.1 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckIssuedTime( $now.1, $i ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckValidUntil( $now.1, $j ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckIssuedTime( $now.1, $i0 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckValidUntil( $now.1, $j0 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Restr_ClientValidate_1( $idL, $idL2 )]\l}|{<n12> !Check( pk(~skL),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$idCA, $id, pk(~sk), 'pubKey', ~sn.1, $i, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$j, \<$idL, 'SCT', $sct1, SI5\>, $idL2, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'SCT', $sct2, SI4\>\l)\l|<n13> !Check( PK2,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$idCA, $id, pk(~sk), 'pubKey', ~sn.1, $i, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$j, \<$idL, 'SCT', $sct1, SI5\>, $idL2, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'SCT', $sct2, SI4\>\l)\l}}",fillcolor="#f2ce03",style="filled",fontcolor="black",role="Undefined"];
n20[shape="record",label="{{<n15> Fr( ~session )|<n16> In( $idC )|<n17> !Logger( $idL, pk(~skL) )}|{<n18> #t2 : ProofFetching_C[FetchLogSnapshot( $idC, $idL, ~session ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ClientFetchesLogSnapshot( $idC, $idL, ~session ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.2 )]\l}|{<n19> !TLS_C_to_L( $idC, $idL, ~session )}}",fillcolor="#10bcc5",style="filled",fontcolor="black",role="Undefined"];
n26[shape="record",label="{{<n21> !Logger_s( $idL, ~skL, pk(~skL) )|<n22> Fr( ~sthment )|<n23> !TLS_C_to_L( $idC, $idL, ~session )}|{<n24> #t3 : LoggerSnapshot_C[LoggerPresentsView( $idL, $idC, $log_id, $now.3, ~sthment,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~session\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerHandsOutSTH( $idL, ~sthment, ~session ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.3 )]\l}|{<n25> !TLS_L_to_C( $idL, $idC, $snapshot, ~sthment, ~session )}}",fillcolor="#22d6d6",style="filled",fontcolor="black",role="Undefined"];
n32[shape="record",label="{{<n27> !TLS_L_to_C( $idL,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$idC, $snapshot,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~sthment, ~session\l)\l|<n28> !Logger( $idL,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skL)\l)\l|<n29> In( $idC )|<n30> !Check( pk(~skL),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$idCA, $id, pk(~sk), 'pubKey', ~sn.1, $i, $j, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$idL, 'SCT', $sct1, SI5\>, $idL2, 'SCT', $sct2, SI4\>\l)\l}|{<n31> #t5 : ClientFindsInclusionViolation[InclusionProofFailed( $idL,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$idCA, $id, pk(~sk), ~sn.1\>\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ClientChecksInclusion( $idL, \<$idCA, $id, pk(~sk), ~sn.1\>, ~sthment, ~session ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ClientFindsInclusionViol( $idL, \<$idCA, $id, pk(~sk), ~sn.1\>, ~sthment, ~session ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InclusionProofFails( $idC, $idL, \<$idCA, $id, pk(~sk), PR1, ~sn.1, $i, $j\>, ~sthment,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~session\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InclusionProof( $idC, $idL, \<$idCA, $id, pk(~sk), PR1, ~sn.1, $i, $j\>, ~sthment,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~session\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.4 )]\l}}",fillcolor="#e65208",style="filled",fontcolor="white",role="Undefined"];
n33[label="#vf : isend",shape="ellipse"];
n34[label="#vk : coerce[!KU( SI2 )]",shape="ellipse"];
n43[shape="record",label="{{<n35> Fr( ~skCA )|<n36> Fr( ~sn.2 )}|{<n37> #vr : Root_CA_Init[CA_Registered( $rootCA, ~skCA, pk(~skCA) ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root_CA_Init( $rootCA ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.5 )]\l}|{<n38> Out( \<$rootCA, $rootCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA), 'selfCert', \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~sn.2, $now.5, $j.1\>\l)\l|<n39> Out( sign(\<$rootCA, $rootCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA), 'selfCert', \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~sn.2, $now.5, $j.1\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~skCA)\l)\l|<n40> Out( \<$rootCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA)\>\l)\l|<n41> !Root_CA_s0( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~skCA, pk(~skCA)\l)\l|<n42> !Root_CA( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA)\l)\l}}",fillcolor="#620c97",style="filled",fontcolor="white",role="Undefined"];
n44[label="#vf.1 : isend",shape="ellipse"];
n45[label="#vk.1 : c_sign[!KU( SI5 )]",shape="ellipse"];
n50[shape="record",label="{{<n46> Fr( ~skL )}|{<n47> #vr.1 : Logger_Init[Logger_Registered( $idL ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.6 )]\l}|{<n48> !Logger_s( $idL, ~skL, pk(~skL) )|<n49> !Logger( $idL, pk(~skL) )}}",fillcolor="#08a358",style="filled",fontcolor="white",role="Undefined"];
n51[label="#vf.2 : isend",shape="ellipse"];
n52[label="#vk.2 : coerce[!KU( ~skL )]",shape="ellipse"];
n53[label="#vl.2 : irecv",shape="ellipse"];
n58[shape="record",label="{{<n54> Fr( ~skL.1 )}|{<n55> #vr.2 : Logger_Init[Logger_Registered( $idL2 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.7 )]\l}|{<n56> !Logger_s( $idL2, ~skL.1, PK2 )|<n57> !Logger( $idL2, PK2 )}}",fillcolor="#08a358",style="filled",fontcolor="white",role="Undefined"];
n59[label="#vf.3 : isend",shape="ellipse"];
n60[label="#vk.3 : coerce[!KU( SI4 )]",shape="ellipse"];
n70[shape="record",label="{{<n61> Fr( ~skCA.1 )|<n62> Fr( ~sn )|<n63> !Root_CA_s0( $rootCA, ~skCA, pk(~skCA) )}|{<n64> #vr.3 : CA_Init[CA_Registered( $idCA, ~skCA.1, PK1 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NonRoot_CA_Init( $idCA ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DocumentedCA( $rootCA, $idCA, \<$rootCA, $idCA, PK1, PU1, ~sn, $i0, $j0\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $i0 )]\l}|{<n65> Out( \<$rootCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$idCA, PK1, PU1, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~sn, $i0, $j0\>\l)\l|<n66> Out( SI2 )|<n67> Out( \<$idCA, PK1\> )|<n68> !CA_s0( $idCA, ~skCA.1, PK1,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, PK1, PU1, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~sn, $i0, $j0\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SI2\l)\l|<n69> !CA_Documentation( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$idCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, PK1, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PU1, ~sn, $i0, $j0\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SI2\l)\l}}",fillcolor="#c871ff",style="filled",fontcolor="black",role="Undefined"];
n71[label="#vf.4 : isend",shape="ellipse"];
n72[label="#vk.4 : coerce[!KU( SI1 )]",shape="ellipse"];
n77[shape="record",label="{{<n73> !Logger_s( $idL, ~skL, pk(~skL) )}|{<n74> #vr.4 : compromiseLogger[CompromiseLogger( $idL ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CompromiseLoggerUniq( \<$idL, ~skL, pk(~skL)\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Compromise( ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Corrupted( $idL ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.8 )]\l}|{<n75> Out( ~skL )|<n76> !Corrupted_Logger( $idL, ~skL, pk(~skL) )}}",fillcolor="#d40808",style="filled",fontcolor="white",role="Undefined"];
n78[label="#vk.5 : coerce[!KU( SI3 )]",shape="ellipse"];
n79[label="#vl.5 : irecv",shape="ellipse"];
n89[shape="record",label="{{<n80> In( \<$idCA, $id, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~sk), PR1, ~sn.1, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i, $j\>\l)\l|<n81> In( SI3 )|<n82> In( \<$rootCA, $idCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PK1, PU1, ~sn, $i0, $j0\l&nbsp;&nbsp;&nbsp;&nbsp;\>\l)\l|<n83> In( SI2 )|<n84> !Logger_s( $idL2,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~skL.1, PK2\l)\l|<n85> !Root_CA( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA)\l)\l|<n86> !Log( $idL2,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$log_id.1\l)\l}|{<n87> #vr.5 : add_preC_to_log[Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerComputesAddLogStmt( $idL2, $log_id.1, \<$idCA, $id, pk(~sk), ~sn.1\>, $sct2 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerComputesAddLog( $idL2, $log_id.1, \<$idCA, $id, pk(~sk), PR1, ~sn.1, $i, $j\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<\<\<$idCA, $id, pk(~sk), PR1, ~sn.1, $i, $j\>, SI3\>, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, PK1, PU1, ~sn, $i0, $j0\>, SI2\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sct2\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerAsserts( $idL2, \<$idL2, 'SCT', $sct2, SI4\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $sct2 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckIssuedTime( $sct2, $i ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckValidUntil( $sct2, $j )]\l}|{<n88> Out( \<$idL2, 'SCT', $sct2, SI4\> )}}",fillcolor="#08a358",style="filled",fontcolor="white",role="Undefined"];
n90[label="#vk.6 : coerce[!KU( ~sn )]",shape="ellipse"];
n91[label="#vl.6 : irecv",shape="ellipse"];
n92[label="#vr.6 : d_0_snd",shape="ellipse"];
n93[label="#vk.7 : coerce[!KU( ~sn.1 )]",shape="ellipse"];
n94[label="#vr.7 : d_0_snd",shape="ellipse"];
n95[label="#vk.8 : coerce[!KU( PK1 )]",shape="ellipse"];
n96[label="#vr.8 : d_0_snd",shape="ellipse"];
n97[label="#vk.9 : coerce[!KU( pk(~sk) )]",shape="ellipse"];
n101[shape="record",label="{{<n98> !Logger_s( $idL2, ~skL.1, PK2 )}|{<n99> #vr.9 : Start_Log[StartedLog( $idL2, $log_id.1 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HonestStartedLog( $idL2, $log_id.1 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.9 )]\l}|{<n100> !Log( $idL2, $log_id.1 )}}",fillcolor="#08a358",style="filled",fontcolor="white",role="Undefined"];
n111[shape="record",label="{{<n102> !CA_s0( $idCA, ~skCA.1,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PK1,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, PK1, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PU1, ~sn, $i0, $j0\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SI2\l)\l|<n103> In( \<$idL, 'SCT', \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sct1, SI5\>\l)\l|<n104> In( \<$idL2, 'SCT', \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sct2, SI4\>\l)\l|<n105> !Logger( $idL,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skL)\l)\l|<n106> !Logger( $idL2, PK2\l)\l|<n107> Certificate_Store( $idCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$idCA, $id, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~sk), PR1, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~sn.1, $i, $j\>, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SI3\>\l)\l}|{<n108> #vr.10 : PubKeyCertify[Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Certified( $idCA, $idL, \<$idL, 'SCT', $sct1, SI5\>, $idL2, \<$idL2, 'SCT', $sct2, SI4\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CAAsserts( $idCA, \<$idCA, $id, pk(~sk), ~sn.1\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.10 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckIssuedTime( $now.10, $i ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckValidUntil( $now.10, $j ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Restr_PubKeyCertify_1( $idL, $idL2 )]\l}|{<n109> Out( \<$idCA, $id, pk(~sk), 'pubKey', ~sn.1, $i, $j, \<$idL, 'SCT', $sct1, SI5\>, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$idL2, 'SCT', $sct2, SI4\>\l)\l|<n110> Out( SI1 )}}",fillcolor="#c871ff",style="filled",fontcolor="black",role="Undefined"];
n112[label="#vf.11 : isend",shape="ellipse"];
n122[shape="record",label="{{<n113> !DomainOwner( $id,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~sk)\l)\l|<n114> !CA_s0( $idCA, ~skCA.1, PK1,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, PK1, PU1, ~sn, $i0, $j0\>, SI2\l)\l|<n115> Fr( ~sn.1 )}|{<n116> #vr.11 : PreCertify[PreCertified( $idCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<\<$idCA, $id, pk(~sk), PR1, ~sn.1, $i, $j\>, SI3\>\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GroundTruth( $idCA, \<$idCA, $id, pk(~sk), ~sn.1\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Asserts_PKI( $idCA, \<$idCA, $id, pk(~sk), ~sn.1\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $i )]\l}|{<n117> Out( \<$idCA, $id, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~sk), PR1, ~sn.1, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i, $j\>\l)\l|<n118> Out( SI3 )|<n119> Certificate_Store( $idCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$idCA, $id, pk(~sk), PR1, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~sn.1, $i, $j\>, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SI3\>\l)\l|<n120> Out( \<$rootCA, $idCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PK1, PU1, ~sn, $i0, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$j0\>\l)\l|<n121> Out( SI2 )}}",fillcolor="#c871ff",style="filled",fontcolor="black",role="Undefined"];
n127[shape="record",label="{{<n123> Fr( ~sk )}|{<n124> #vr.12 : Domain_Owner_Init[Time( $now.11 )]}|{<n125> !DomainOwner( $id, pk(~sk) )|<n126> Out( pk(~sk) )}}",fillcolor="#c6c6c6",style="filled",fontcolor="black",role="Undefined"];
n128[label="#vr.13 : d_0_snd",shape="ellipse"];
n129[label="#vf.14 : isend",shape="ellipse"];
n130[label="#vr.14 : d_0_snd",shape="ellipse"];
n131[label="#vf.15 : isend",shape="ellipse"];
n132[label="#vr.15 : d_0_snd",shape="ellipse"];
n133[label="#vf.16 : isend",shape="ellipse"];
n134[label="#vr.16 : d_0_snd",shape="ellipse"];
n135[label="#vf.17 : isend",shape="ellipse"];
n136[label="#vf.18 : isend",shape="ellipse"];
n137[label="#vr.18 : d_0_snd",shape="ellipse"];
n138[label="#vf.19 : isend",shape="ellipse"];
n139[label="#vr.19 : d_0_snd",shape="ellipse"];
n140[label="#vr.20 : d_0_snd",shape="ellipse"];
n141[label="#vr.21 : d_0_snd",shape="ellipse"];
n14:n12 -> n32:n30[style="bold",weight="10.0",color="gray50"];
n20:n19 -> n26:n23[style="bold",weight="10.0",color="gray50"];
n26:n25 -> n32:n27[style="bold",weight="10.0",color="gray50"];
n33 -> n14:n5[color="gray30"];
n43:n41 -> n70:n63[style="bold",weight="10.0",color="gray50"];
n43:n42 -> n14:n4[style="bold",weight="10.0",color="gray50"];
n43:n42 -> n89:n85[style="bold",weight="10.0",color="gray50"];
n44 -> n14:n6[color="gray30"];
n50:n48 -> n3:n0[style="bold",weight="10.0",color="gray50"];
n50:n48 -> n26:n21[style="bold",weight="10.0",color="gray50"];
n50:n48 -> n77:n73[style="bold",weight="10.0",color="gray50"];
n50:n49 -> n14:n9[style="bold",weight="10.0",color="gray50"];
n50:n49 -> n20:n17[style="bold",weight="10.0",color="gray50"];
n50:n49 -> n32:n28[style="bold",weight="10.0",color="gray50"];
n50:n49 -> n111:n105[style="bold",weight="10.0",color="gray50"];
n51 -> n14:n7[color="gray30"];
n53 -> n92[color="orangered2"];
n58:n56 -> n89:n84[style="bold",weight="10.0",color="gray50"];
n58:n56 -> n101:n98[style="bold",weight="10.0",color="gray50"];
n58:n57 -> n14:n10[style="bold",weight="10.0",color="gray50"];
n58:n57 -> n111:n106[style="bold",weight="10.0",color="gray50"];
n59 -> n14:n8[color="gray30"];
n70:n65 -> n79[color="gray30"];
n70:n66 -> n34[color="orangered2"];
n70:n68 -> n111:n102[style="bold",weight="10.0",color="gray50"];
n70:n68 -> n122:n114[style="bold",weight="10.0",color="gray50"];
n71 -> n32:n29[color="gray30"];
n77:n75 -> n52[color="orangered2"];
n79 -> n128[color="orangered2"];
n89:n88 -> n53[color="gray30"];
n91 -> n137[color="orangered2"];
n92 -> n94[color="orangered2"];
n94 -> n96[color="orangered2"];
n96 -> n60[color="orangered2"];
n101:n100 -> n89:n86[style="bold",weight="10.0",color="gray50"];
n111:n110 -> n72[color="orangered2"];
n112 -> n20:n16[color="gray30"];
n122:n117 -> n91[color="gray30"];
n122:n118 -> n78[color="orangered2"];
n122:n119 -> n111:n107[style="bold",weight="10.0"];
n127:n125 -> n122:n113[style="bold",weight="10.0",color="gray50"];
n127:n126 -> n97[color="orangered2"];
n128 -> n130[color="orangered2"];
n129 -> n89:n80[color="gray30"];
n130 -> n95[color="orangered2"];
n130 -> n132[color="orangered2"];
n131 -> n89:n81[color="gray30"];
n132 -> n134[color="orangered2"];
n133 -> n89:n82[color="gray30"];
n134 -> n90[color="orangered2"];
n135 -> n89:n83[color="gray30"];
n136 -> n111:n103[color="gray30"];
n137 -> n139[color="orangered2"];
n138 -> n111:n104[color="gray30"];
n139 -> n140[color="orangered2"];
n140 -> n141[color="orangered2"];
n141 -> n93[color="orangered2"];
n3:n1 -> n26:n24[color="black",style="dashed"];
n14:n11 -> n20:n18[color="black",style="dashed"];
n34 -> n44[color="red",style="dashed"];
n34 -> n135[color="red",style="dashed"];
n45 -> n51[color="red",style="dashed"];
n45 -> n136[color="red",style="dashed"];
n52 -> n45[color="red",style="dashed"];
n53 -> n51[color="red",style="dashed"];
n53 -> n138[color="red",style="dashed"];
n60 -> n51[color="red",style="dashed"];
n60 -> n138[color="red",style="dashed"];
n72 -> n59[color="red",style="dashed"];
n78 -> n131[color="red",style="dashed"];
n79 -> n33[color="red",style="dashed"];
n79 -> n133[color="red",style="dashed"];
n90 -> n33[color="red",style="dashed"];
n90 -> n133[color="red",style="dashed"];
n91 -> n129[color="red",style="dashed"];
n92 -> n51[color="red",style="dashed"];
n92 -> n138[color="red",style="dashed"];
n93 -> n45[color="red",style="dashed"];
n93 -> n51[color="red",style="dashed"];
n93 -> n129[color="red",style="dashed"];
n94 -> n51[color="red",style="dashed"];
n94 -> n138[color="red",style="dashed"];
n95 -> n33[color="red",style="dashed"];
n95 -> n133[color="red",style="dashed"];
n97 -> n45[color="red",style="dashed"];
n97 -> n51[color="red",style="dashed"];
n97 -> n129[color="red",style="dashed"];
n128 -> n33[color="red",style="dashed"];
n128 -> n133[color="red",style="dashed"];
n130 -> n33[color="red",style="dashed"];
n130 -> n133[color="red",style="dashed"];
n132 -> n33[color="red",style="dashed"];
n132 -> n133[color="red",style="dashed"];
n134 -> n33[color="red",style="dashed"];
n134 -> n133[color="red",style="dashed"];
n137 -> n129[color="red",style="dashed"];
n139 -> n129[color="red",style="dashed"];
n140 -> n129[color="red",style="dashed"];
n141 -> n45[color="red",style="dashed"];
n141 -> n129[color="red",style="dashed"];
{
rank="sink";
n142[shape="plain",label=<<TABLE BORDER="1" CELLBORDER="0" CELLSPACING="3" CELLPADDING="1"><TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">PK1</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">pk(~skCA.1)</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">PK2</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">pk(~skL.1)</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">PR1</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">'pre-cert'</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">PU1</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">'pubKey-CA'</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">SI2</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">sign(&lt;$rootCA, $idCA, PK1, PU1, ~sn, $i0, $j0&gt;, ~skCA)</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">SI3</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">sign(&lt;$idCA, $id, pk(~sk), PR1, ~sn.1, $i, $j&gt;, ~skCA.1)</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">SI4</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">sign(&lt;$idL2, 'SCT', $sct2, $idCA, $id, pk(~sk), ~sn.1, $i, $j&gt;,<BR ALIGN="LEFT"/> &#32;&#32;&#32;&#32;~skL.1)</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">SI5</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">sign(&lt;$idL, 'SCT', $sct1, $idCA, $id, pk(~sk), ~sn.1, $i, $j&gt;,<BR ALIGN="LEFT"/> &#32;&#32;&#32;&#32;~skL)</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">SI1</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">sign(&lt;$idCA, $id, pk(~sk), 'pubKey', ~sn.1, $i, $j, <BR ALIGN="LEFT"/> &#32;&#32;&#32;&#32;&#32;&lt;$idL, 'SCT', $sct1, SI5&gt;, $idL2, 'SCT', $sct2, SI4&gt;,<BR ALIGN="LEFT"/> &#32;&#32;&#32;&#32;~skCA.1)</TD></TR></TABLE>>];

}
n32:n31 -> n142[style="invis"];

}
