digraph "trace_ct_SL2-AS0-CL0-A1-C1-NB_san_CT_PubKeyCertify-Domain_Owner_Init-CA_Init-CA_Init-Logger_Init-Logger_Init-PreCertify-add_preC_to_log-Logger_Init-Root_CA_Init-Start_Log-add_preC_to_log-Logger_Init-Root_CA_Init-Start_Log-add_preC_to_log-case_1-add_preC_to_log-case_2-PreCertify-CA_Init-PreCertify-CA_Init-CA_Init_case_1-Domain_Owner_Init" {
nodesep="0.3";
ranksep="0.3";
node[fontsize="8",fontname="Helvetica",width="0.3",height="0.2"];
edge[fontsize="8",fontname="Helvetica"];
n9[shape="record",label="{{<n0> !DomainOwner( $id,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~sk)\l)\l|<n1> !CA_s0( $idCA, ~skCA, pk(~skCA),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, pk(~skCA), PU1, ~sn, $i0, $j\>, SI1\l)\l|<n2> Fr( ~sn.1 )}|{<n3> #t1 : PreCertify[PreCertified( $idCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<\<$idCA, $id, pk(~sk), PR1, ~sn.1, $i, $j.1\>, SI2\>\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GroundTruth( $idCA, \<$idCA, $id, pk(~sk), ~sn.1\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Asserts_PKI( $idCA, \<$idCA, $id, pk(~sk), ~sn.1\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $i )]\l}|{<n4> Out( \<$idCA, $id, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~sk), PR1, ~sn.1, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i, $j.1\>\l)\l|<n5> Out( SI2 )|<n6> Certificate_Store( $idCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$idCA, $id, pk(~sk), PR1, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~sn.1, $i, $j.1\>, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SI2\>\l)\l|<n7> Out( \<$rootCA, $idCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA), PU1, ~sn, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i0, $j\>\l)\l|<n8> Out( SI1 )}}",fillcolor="#c871ff",style="filled",fontcolor="black",role="Undefined"];
n19[shape="record",label="{{<n10> In( \<$idCA, $id, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~sk), PR1, ~sn.1, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i, $j.1\>\l)\l|<n11> In( SI2 )|<n12> In( \<$rootCA, $idCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA), PU1, ~sn, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i0, $j\>\l)\l|<n13> In( SI1 )|<n14> !Logger_s( $idL1,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~skL, pk(~skL)\l)\l|<n15> !Root_CA( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PK1\l)\l|<n16> !Log( $idL1, $log_id\l)\l}|{<n17> #t2 : add_preC_to_log[Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerComputesAddLogStmt( $idL1, $log_id, \<$idCA, $id, pk(~sk), ~sn.1\>, $sct1 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerComputesAddLog( $idL1, $log_id, \<$idCA, $id, pk(~sk), PR1, ~sn.1, $i, $j.1\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<\<\<$idCA, $id, pk(~sk), PR1, ~sn.1, $i, $j.1\>, SI2\>, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, pk(~skCA), PU1, ~sn, $i0, $j\>, SI1\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sct1\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerAsserts( $idL1, \<$idL1, 'SCT', $sct1, SI4\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $sct1 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckIssuedTime( $sct1, $i ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckValidUntil( $sct1, $j.1 )]\l}|{<n18> Out( \<$idL1, 'SCT', $sct1, SI4\> )}}",fillcolor="#08a358",style="filled",fontcolor="white",role="Undefined"];
n29[shape="record",label="{{<n20> In( \<$idCA, $id, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~sk), PR1, ~sn.1, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i, $j.1\>\l)\l|<n21> In( SI2 )|<n22> In( \<$rootCA, $idCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA), PU1, ~sn, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i0, $j\>\l)\l|<n23> In( SI1 )|<n24> !Logger_s( $idL2,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~skL.1, PK2\l)\l|<n25> !Root_CA( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PK1\l)\l|<n26> !Log( $idL2,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$log_id.1\l)\l}|{<n27> #t3 : add_preC_to_log[Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerComputesAddLogStmt( $idL2, $log_id.1, \<$idCA, $id, pk(~sk), ~sn.1\>, $sct2 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerComputesAddLog( $idL2, $log_id.1, \<$idCA, $id, pk(~sk), PR1, ~sn.1, $i, $j.1\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<\<\<$idCA, $id, pk(~sk), PR1, ~sn.1, $i, $j.1\>, SI2\>, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, pk(~skCA), PU1, ~sn, $i0, $j\>, SI1\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sct2\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerAsserts( $idL2, \<$idL2, 'SCT', $sct2, SI3\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $sct2 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckIssuedTime( $sct2, $i ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckValidUntil( $sct2, $j.1 )]\l}|{<n28> Out( \<$idL2, 'SCT', $sct2, SI3\> )}}",fillcolor="#08a358",style="filled",fontcolor="white",role="Undefined"];
n39[shape="record",label="{{<n30> !CA_s0( $idCA, ~skCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA), PU1, ~sn, $i0, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$j\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SI1\l)\l|<n31> In( \<$idL1, 'SCT', \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sct1, SI4\>\l)\l|<n32> In( \<$idL2, 'SCT', \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sct2, SI3\>\l)\l|<n33> !Logger( $idL1,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skL)\l)\l|<n34> !Logger( $idL2, PK2\l)\l|<n35> Certificate_Store( $idCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$idCA, $id, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~sk), PR1, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~sn.1, $i, $j.1\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\>, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SI2\>\l)\l}|{<n36> #t4 : PubKeyCertify[Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Certified( $idCA, $idL1, \<$idL1, 'SCT', $sct1, SI4\>, $idL2, \<$idL2, 'SCT', $sct2, SI3\>\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CAAsserts( $idCA, \<$idCA, $id, pk(~sk), ~sn.1\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckIssuedTime( $now, $i ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckValidUntil( $now, $j.1 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Restr_PubKeyCertify_1( $idL1, $idL2 )]\l}|{<n37> Out( \<$idCA, $id, pk(~sk), 'pubKey', \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~sn.1, $i, $j.1, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$idL1, 'SCT', $sct1, SI4\>, $idL2, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'SCT', $sct2, SI3\>\l)\l|<n38> Out( sign(\<$idCA, $id, pk(~sk), 'pubKey', \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~sn.1, $i, $j.1, \<$idL1, 'SCT', $sct1, SI4\>, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$idL2, 'SCT', $sct2, SI3\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~skCA)\l)\l}}",fillcolor="#c871ff",style="filled",fontcolor="black",role="Undefined"];
n40[label="#vk : coerce[!KU( SI4 )]",shape="ellipse"];
n41[label="#vl : irecv",shape="ellipse"];
n46[shape="record",label="{{<n42> Fr( ~sk )}|{<n43> #vr : Domain_Owner_Init[Time( $now.1 )]}|{<n44> !DomainOwner( $id, pk(~sk) )|<n45> Out( pk(~sk) )}}",fillcolor="#c6c6c6",style="filled",fontcolor="black",role="Undefined"];
n47[label="#vf.1 : isend",shape="ellipse"];
n48[label="#vk.1 : coerce[!KU( SI3 )]",shape="ellipse"];
n49[label="#vl.1 : irecv",shape="ellipse"];
n59[shape="record",label="{{<n50> Fr( ~skCA )|<n51> Fr( ~sn )|<n52> !Root_CA_s0( $rootCA, ~skCA.1, PK1 )}|{<n53> #vr.1 : CA_Init[CA_Registered( $idCA, ~skCA, pk(~skCA) ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NonRoot_CA_Init( $idCA ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DocumentedCA( $rootCA, $idCA, \<$rootCA, $idCA, pk(~skCA), PU1, ~sn, $i0, $j\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $i0 )]\l}|{<n54> Out( \<$rootCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$idCA, pk(~skCA), \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PU1, ~sn, $i0, $j\>\l)\l|<n55> Out( SI1 )|<n56> Out( \<$idCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA)\>\l)\l|<n57> !CA_s0( $idCA, ~skCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, pk(~skCA), \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PU1, ~sn, $i0, $j\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SI1\l)\l|<n58> !CA_Documentation( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$idCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA), PU1, ~sn, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i0, $j\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SI1\l)\l}}",fillcolor="#c871ff",style="filled",fontcolor="black",role="Undefined"];
n60[label="#vf.2 : isend",shape="ellipse"];
n61[label="#vk.2 : coerce[!KU( SI2 )]",shape="ellipse"];
n70[shape="record",label="{{<n62> Fr( ~skCA.1 )|<n63> Fr( ~sn.2 )}|{<n64> #vr.2 : Root_CA_Init[CA_Registered( $rootCA, ~skCA.1, PK1 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root_CA_Init( $rootCA ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.2 )]\l}|{<n65> Out( \<$rootCA, $rootCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PK1, 'selfCert', ~sn.2, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$now.2, $j.2\>\l)\l|<n66> Out( sign(\<$rootCA, $rootCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PK1, 'selfCert', ~sn.2, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$now.2, $j.2\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~skCA.1)\l)\l|<n67> Out( \<$rootCA, PK1\>\l)\l|<n68> !Root_CA_s0( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~skCA.1, PK1\l)\l|<n69> !Root_CA( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PK1\l)\l}}",fillcolor="#620c97",style="filled",fontcolor="white",role="Undefined"];
n71[label="#vk.3 : coerce[!KU( SI1 )]",shape="ellipse"];
n76[shape="record",label="{{<n72> Fr( ~skL )}|{<n73> #vr.3 : Logger_Init[Logger_Registered( $idL1 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.3 )]\l}|{<n74> !Logger_s( $idL1, ~skL, pk(~skL) )|<n75> !Logger( $idL1, pk(~skL) )}}",fillcolor="#08a358",style="filled",fontcolor="white",role="Undefined"];
n77[label="#vk.4 : coerce[!KU( ~sn.1 )]",shape="ellipse"];
n78[label="#vl.4 : irecv",shape="ellipse"];
n83[shape="record",label="{{<n79> Fr( ~skL.1 )}|{<n80> #vr.4 : Logger_Init[Logger_Registered( $idL2 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.4 )]\l}|{<n81> !Logger_s( $idL2, ~skL.1, PK2 )|<n82> !Logger( $idL2, PK2 )}}",fillcolor="#08a358",style="filled",fontcolor="white",role="Undefined"];
n84[label="#vk.5 : coerce[!KU( ~sn )]",shape="ellipse"];
n85[label="#vl.5 : irecv",shape="ellipse"];
n89[shape="record",label="{{<n86> !Logger_s( $idL1, ~skL, pk(~skL) )}|{<n87> #vr.5 : Start_Log[StartedLog( $idL1, $log_id ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HonestStartedLog( $idL1, $log_id ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.5 )]\l}|{<n88> !Log( $idL1, $log_id )}}",fillcolor="#08a358",style="filled",fontcolor="white",role="Undefined"];
n90[label="#vk.6 : coerce[!KU( pk(~skCA) )]",shape="ellipse"];
n94[shape="record",label="{{<n91> !Logger_s( $idL2, ~skL.1, PK2 )}|{<n92> #vr.6 : Start_Log[StartedLog( $idL2, $log_id.1 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HonestStartedLog( $idL2, $log_id.1 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.6 )]\l}|{<n93> !Log( $idL2, $log_id.1 )}}",fillcolor="#08a358",style="filled",fontcolor="white",role="Undefined"];
n95[label="#vk.7 : coerce[!KU( pk(~sk) )]",shape="ellipse"];
n96[label="#vr.7 : d_0_snd",shape="ellipse"];
n97[label="#vr.8 : d_0_snd",shape="ellipse"];
n98[label="#vr.9 : d_0_snd",shape="ellipse"];
n99[label="#vf.10 : isend",shape="ellipse"];
n100[label="#vr.10 : d_0_snd",shape="ellipse"];
n101[label="#vf.11 : isend",shape="ellipse"];
n102[label="#vr.11 : d_0_snd",shape="ellipse"];
n103[label="#vf.12 : isend",shape="ellipse"];
n104[label="#vr.12 : d_0_snd",shape="ellipse"];
n105[label="#vf.13 : isend",shape="ellipse"];
n106[label="#vr.13 : d_0_snd",shape="ellipse"];
n107[label="#vf.14 : isend",shape="ellipse"];
n108[label="#vr.14 : d_0_snd",shape="ellipse"];
n109[label="#vf.15 : isend",shape="ellipse"];
n110[label="#vr.15 : d_0_snd",shape="ellipse"];
n111[label="#vf.16 : isend",shape="ellipse"];
n112[label="#vr.16 : d_0_snd",shape="ellipse"];
n113[label="#vf.17 : isend",shape="ellipse"];
n114[label="#vr.18 : d_0_snd",shape="ellipse"];
n115[label="#vr.19 : d_0_snd",shape="ellipse"];
n116[label="#vr.20 : d_0_snd",shape="ellipse"];
n117[label="#vr.21 : d_0_snd",shape="ellipse"];
n9:n4 -> n78[color="gray30"];
n9:n5 -> n61[color="orangered2"];
n9:n6 -> n39:n35[style="bold",weight="10.0"];
n19:n18 -> n41[color="gray30"];
n29:n28 -> n49[color="gray30"];
n41 -> n96[color="orangered2"];
n46:n44 -> n9:n0[style="bold",weight="10.0",color="gray50"];
n46:n45 -> n95[color="orangered2"];
n47 -> n39:n31[color="gray30"];
n49 -> n100[color="orangered2"];
n59:n54 -> n85[color="gray30"];
n59:n55 -> n71[color="orangered2"];
n59:n57 -> n9:n1[style="bold",weight="10.0",color="gray50"];
n59:n57 -> n39:n30[style="bold",weight="10.0",color="gray50"];
n60 -> n39:n32[color="gray30"];
n70:n68 -> n59:n52[style="bold",weight="10.0",color="gray50"];
n70:n69 -> n19:n15[style="bold",weight="10.0",color="gray50"];
n70:n69 -> n29:n25[style="bold",weight="10.0",color="gray50"];
n76:n74 -> n19:n14[style="bold",weight="10.0",color="gray50"];
n76:n74 -> n89:n86[style="bold",weight="10.0",color="gray50"];
n76:n75 -> n39:n33[style="bold",weight="10.0",color="gray50"];
n78 -> n106[color="orangered2"];
n83:n81 -> n29:n24[style="bold",weight="10.0",color="gray50"];
n83:n81 -> n94:n91[style="bold",weight="10.0",color="gray50"];
n83:n82 -> n39:n34[style="bold",weight="10.0",color="gray50"];
n85 -> n114[color="orangered2"];
n89:n88 -> n19:n16[style="bold",weight="10.0",color="gray50"];
n94:n93 -> n29:n26[style="bold",weight="10.0",color="gray50"];
n96 -> n97[color="orangered2"];
n97 -> n98[color="orangered2"];
n98 -> n40[color="orangered2"];
n99 -> n19:n10[color="gray30"];
n100 -> n102[color="orangered2"];
n101 -> n19:n11[color="gray30"];
n102 -> n104[color="orangered2"];
n103 -> n19:n12[color="gray30"];
n104 -> n48[color="orangered2"];
n105 -> n19:n13[color="gray30"];
n106 -> n108[color="orangered2"];
n107 -> n29:n20[color="gray30"];
n108 -> n110[color="orangered2"];
n109 -> n29:n21[color="gray30"];
n110 -> n112[color="orangered2"];
n111 -> n29:n22[color="gray30"];
n112 -> n77[color="orangered2"];
n113 -> n29:n23[color="gray30"];
n114 -> n115[color="orangered2"];
n115 -> n90[color="orangered2"];
n115 -> n116[color="orangered2"];
n116 -> n117[color="orangered2"];
n117 -> n84[color="orangered2"];
n19:n17 -> n29:n27[color="black",style="dashed"];
n29:n27 -> n39:n36[color="black",style="dashed"];
n40 -> n47[color="red",style="dashed"];
n41 -> n47[color="red",style="dashed"];
n48 -> n60[color="red",style="dashed"];
n49 -> n60[color="red",style="dashed"];
n61 -> n101[color="red",style="dashed"];
n61 -> n109[color="red",style="dashed"];
n71 -> n105[color="red",style="dashed"];
n71 -> n113[color="red",style="dashed"];
n77 -> n99[color="red",style="dashed"];
n77 -> n107[color="red",style="dashed"];
n78 -> n99[color="red",style="dashed"];
n78 -> n107[color="red",style="dashed"];
n84 -> n103[color="red",style="dashed"];
n84 -> n111[color="red",style="dashed"];
n85 -> n103[color="red",style="dashed"];
n85 -> n111[color="red",style="dashed"];
n90 -> n103[color="red",style="dashed"];
n90 -> n111[color="red",style="dashed"];
n95 -> n99[color="red",style="dashed"];
n95 -> n107[color="red",style="dashed"];
n96 -> n47[color="red",style="dashed"];
n97 -> n47[color="red",style="dashed"];
n100 -> n60[color="red",style="dashed"];
n102 -> n60[color="red",style="dashed"];
n106 -> n99[color="red",style="dashed"];
n106 -> n107[color="red",style="dashed"];
n108 -> n99[color="red",style="dashed"];
n108 -> n107[color="red",style="dashed"];
n110 -> n99[color="red",style="dashed"];
n110 -> n107[color="red",style="dashed"];
n112 -> n99[color="red",style="dashed"];
n112 -> n107[color="red",style="dashed"];
n114 -> n103[color="red",style="dashed"];
n114 -> n111[color="red",style="dashed"];
n115 -> n103[color="red",style="dashed"];
n115 -> n111[color="red",style="dashed"];
n116 -> n103[color="red",style="dashed"];
n116 -> n111[color="red",style="dashed"];
n117 -> n103[color="red",style="dashed"];
n117 -> n111[color="red",style="dashed"];
{
rank="sink";
n118[shape="plain",label=<<TABLE BORDER="1" CELLBORDER="0" CELLSPACING="3" CELLPADDING="1"><TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">PK1</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">pk(~skCA.1)</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">PK2</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">pk(~skL.1)</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">PR1</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">'pre-cert'</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">PU1</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">'pubKey-CA'</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">SI1</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">sign(&lt;$rootCA, $idCA, pk(~skCA), PU1, ~sn, $i0, $j&gt;, ~skCA.1)</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">SI2</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">sign(&lt;$idCA, $id, pk(~sk), PR1, ~sn.1, $i, $j.1&gt;, ~skCA)</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">SI3</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">sign(&lt;$idL2, 'SCT', $sct2, $idCA, $id, pk(~sk), ~sn.1, $i, $j.1&gt;,<BR ALIGN="LEFT"/> &#32;&#32;&#32;&#32;~skL.1)</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">SI4</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">sign(&lt;$idL1, 'SCT', $sct1, $idCA, $id, pk(~sk), ~sn.1, $i, $j.1&gt;,<BR ALIGN="LEFT"/> &#32;&#32;&#32;&#32;~skL)</TD></TR></TABLE>>];

}
n39:n36 -> n118[style="invis"];

}
