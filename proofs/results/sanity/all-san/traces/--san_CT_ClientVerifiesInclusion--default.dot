digraph "trace_ct_SL2-AS0-CL0-A1-C1-NB_san_CT_ClientVerifiesInclusion-LoggerSnapshot_C-Logger_Init-ClientValidate_case_1-LoggerSnapshot_C-add_preC_to_log-Logger_Init-Root_CA_Init-Start_Log-Start_Log-CA_Init-add_preC_to_log-add_preC_to_log-PubKeyCertify-PreCertify-CA_Init-PreCertify-CA_Init-PreCertify-CA_Init-CA_Init-PreCertify-CA_Init_case_1-Domain_Owner_Init" {
nodesep="0.3";
ranksep="0.3";
node[fontsize="8",fontname="Helvetica",width="0.3",height="0.2"];
edge[fontsize="8",fontname="Helvetica"];
n5[shape="record",label="{{<n0> !TLS_L_to_C( $idL,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$idC, $snapshot,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~sthment, ~session\l)\l|<n1> !Logger( $idL,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skL)\l)\l|<n2> !Check( pk(~skL),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$idCA, $id, pk(~sk), 'pubKey', ~sn, $i, $j, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$idL, 'SCT', $sct1, SI5\>, $idL2, 'SCT', $sct2, SI4\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\>\l)\l|<n3> In( $idClient )}|{<n4> #t : ClientVerifiesInclusion[ClientSideInclusionProved( $idL,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$idCA, $id, pk(~sk), ~sn\>, ~sthment, ~session\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InclusionProofSucceeds( $idL, \<$idCA, $id, pk(~sk), PR1, ~sn, $i, $j\>, ~sthment,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~session\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ClientChecksInclusion( $idL, \<$idCA, $id, pk(~sk), ~sn\>, ~sthment, ~session ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;InclusionProof( $idClient, $idL, \<$idCA, $id, pk(~sk), PR1, ~sn, $i, $j\>, ~sthment,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~session\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now )]\l}}",fillcolor="#c1ff3c",style="filled",fontcolor="black",role="Undefined"];
n9[shape="record",label="{{<n6> !Logger_s( $idL, ~skL, pk(~skL) )}|{<n7> #t0 : Start_Log[StartedLog( $idL, $log_id ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HonestStartedLog( $idL, $log_id ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.1 )]\l}|{<n8> !Log( $idL, $log_id )}}",fillcolor="#08a358",style="filled",fontcolor="white",role="Undefined"];
n15[shape="record",label="{{<n10> !Logger_s( $idL, ~skL, pk(~skL) )|<n11> Fr( ~sthment )|<n12> !TLS_C_to_L( $idC, $idL, ~session )}|{<n13> #t2 : LoggerSnapshot_C[LoggerPresentsView( $idL, $idC, $log_id, $now.2, ~sthment,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~session\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerHandsOutSTH( $idL, ~sthment, ~session ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.2 )]\l}|{<n14> !TLS_L_to_C( $idL, $idC, $snapshot, ~sthment, ~session )}}",fillcolor="#22d6d6",style="filled",fontcolor="black",role="Undefined"];
n16[label="#vf : isend",shape="ellipse"];
n17[label="#vk : coerce[!KU( SI2 )]",shape="ellipse"];
n22[shape="record",label="{{<n18> Fr( ~skL )}|{<n19> #vr : Logger_Init[Logger_Registered( $idL ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.3 )]\l}|{<n20> !Logger_s( $idL, ~skL, pk(~skL) )|<n21> !Logger( $idL, pk(~skL) )}}",fillcolor="#08a358",style="filled",fontcolor="white",role="Undefined"];
n32[shape="record",label="{{<n23> In( \<$idCA, $id, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~sk), PR1, ~sn, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i, $j\>\l)\l|<n24> In( SI3 )|<n25> In( \<$rootCA, $idCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA), PU1, ~sn.1, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i0, $j0\>\l)\l|<n26> In( SI2 )|<n27> !Logger_s( $idL,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~skL, pk(~skL)\l)\l|<n28> !Root_CA( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PK1\l)\l|<n29> !Log( $idL, $log_id\l)\l}|{<n30> #t.1 : add_preC_to_log[Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerComputesAddLogStmt( $idL, $log_id, \<$idCA, $id, pk(~sk), ~sn\>, $now.4 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerComputesAddLog( $idL, $log_id, \<$idCA, $id, pk(~sk), PR1, ~sn, $i, $j\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<\<\<$idCA, $id, pk(~sk), PR1, ~sn, $i, $j\>, SI3\>, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, pk(~skCA), PU1, ~sn.1, $i0, $j0\>, SI2\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$now.4\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerAsserts( $idL,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$idL, 'SCT', $now.4, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sign(\<$idL, 'SCT', $now.4, $idCA, $id, pk(~sk), ~sn, $i, $j\>, ~skL)\>\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.4 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckIssuedTime( $now.4, $i ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckValidUntil( $now.4, $j )]\l}|{<n31> Out( \<$idL, 'SCT', $now.4, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sign(\<$idL, 'SCT', $now.4, $idCA, $id, pk(~sk), ~sn, $i, $j\>, ~skL)\>\l)\l}}",fillcolor="#08a358",style="filled",fontcolor="white",role="Undefined"];
n33[label="#vk.1 : coerce[!KU( SI5 )]",shape="ellipse"];
n34[label="#vl.1 : irecv",shape="ellipse"];
n40[shape="record",label="{{<n35> Fr( ~session )|<n36> In( $idC )|<n37> !Logger( $idL, pk(~skL) )}|{<n38> #vr.1 : ProofFetching_C[FetchLogSnapshot( $idC, $idL, ~session ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ClientFetchesLogSnapshot( $idC, $idL, ~session ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.5 )]\l}|{<n39> !TLS_C_to_L( $idC, $idL, ~session )}}",fillcolor="#10bcc5",style="filled",fontcolor="black",role="Undefined"];
n41[label="#vk.2 : coerce[!KU( SI4 )]",shape="ellipse"];
n42[label="#vl.2 : irecv",shape="ellipse"];
n53[shape="record",label="{{<n43> !Root_CA( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PK1\l)\l|<n44> In( \<$rootCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$idCA, pk(~skCA), \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PU1, ~sn.1, $i0, $j0\l&nbsp;&nbsp;&nbsp;&nbsp;\>\l)\l|<n45> In( SI2 )|<n46> In( \<$idCA, $id, pk(~sk), 'pubKey', \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~sn, $i, $j, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$idL, 'SCT', $sct1, SI5\>, $idL2, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'SCT', $sct2, SI4\>\l)\l|<n47> In( SI1 )|<n48> !Logger( $idL,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skL)\l)\l|<n49> !Logger( $idL2, PK2\l)\l}|{<n50> #vr.2 : ClientValidate[ClientAcceptsChain( $idL, $idL2, $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, pk(~skCA), PU1, ~sn.1, $i0, $j0\>, $idCA, \<$idCA, $id, pk(~sk), ~sn\>\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ClientAcceptsCert( $idL, $idL2, \<$idCA, $id, pk(~sk), PR1, ~sn, $i, $j\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.6 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckIssuedTime( $now.6, $i ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckValidUntil( $now.6, $j ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckIssuedTime( $now.6, $i0 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckValidUntil( $now.6, $j0 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Restr_ClientValidate_1( $idL, $idL2 )]\l}|{<n51> !Check( pk(~skL),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$idCA, $id, pk(~sk), 'pubKey', ~sn, $i, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$j, \<$idL, 'SCT', $sct1, SI5\>, $idL2, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'SCT', $sct2, SI4\>\l)\l|<n52> !Check( PK2,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$idCA, $id, pk(~sk), 'pubKey', ~sn, $i, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$j, \<$idL, 'SCT', $sct1, SI5\>, $idL2, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'SCT', $sct2, SI4\>\l)\l}}",fillcolor="#f2ce03",style="filled",fontcolor="black",role="Undefined"];
n54[label="#vk.3 : coerce[!KU( SI1 )]",shape="ellipse"];
n63[shape="record",label="{{<n55> Fr( ~skCA.1 )|<n56> Fr( ~sn.2 )}|{<n57> #vr.3 : Root_CA_Init[CA_Registered( $rootCA, ~skCA.1, PK1 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root_CA_Init( $rootCA ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.7 )]\l}|{<n58> Out( \<$rootCA, $rootCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PK1, 'selfCert', ~sn.2, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$now.7, $j.1\>\l)\l|<n59> Out( sign(\<$rootCA, $rootCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PK1, 'selfCert', ~sn.2, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$now.7, $j.1\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~skCA.1)\l)\l|<n60> Out( \<$rootCA, PK1\>\l)\l|<n61> !Root_CA_s0( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~skCA.1, PK1\l)\l|<n62> !Root_CA( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PK1\l)\l}}",fillcolor="#620c97",style="filled",fontcolor="white",role="Undefined"];
n64[label="#vf.4 : isend",shape="ellipse"];
n65[label="#vk.4 : coerce[!KU( SI3 )]",shape="ellipse"];
n70[shape="record",label="{{<n66> Fr( ~skL.1 )}|{<n67> #vr.4 : Logger_Init[Logger_Registered( $idL2 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.8 )]\l}|{<n68> !Logger_s( $idL2, ~skL.1, PK2 )|<n69> !Logger( $idL2, PK2 )}}",fillcolor="#08a358",style="filled",fontcolor="white",role="Undefined"];
n71[label="#vf.5 : isend",shape="ellipse"];
n72[label="#vk.5 : coerce[!KU( ~sn.1 )]",shape="ellipse"];
n73[label="#vl.5 : irecv",shape="ellipse"];
n83[shape="record",label="{{<n74> Fr( ~skCA )|<n75> Fr( ~sn.1 )|<n76> !Root_CA_s0( $rootCA, ~skCA.1, PK1 )}|{<n77> #vr.5 : CA_Init[CA_Registered( $idCA, ~skCA, pk(~skCA) ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NonRoot_CA_Init( $idCA ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DocumentedCA( $rootCA, $idCA, \<$rootCA, $idCA, pk(~skCA), PU1, ~sn.1, $i0, $j0\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $i0 )]\l}|{<n78> Out( \<$rootCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$idCA, pk(~skCA), \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PU1, ~sn.1, $i0, $j0\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\>\l)\l|<n79> Out( SI2 )|<n80> Out( \<$idCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA)\>\l)\l|<n81> !CA_s0( $idCA, ~skCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, pk(~skCA), \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PU1, ~sn.1, $i0, $j0\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SI2\l)\l|<n82> !CA_Documentation( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$idCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA), PU1, ~sn.1, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i0, $j0\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SI2\l)\l}}",fillcolor="#c871ff",style="filled",fontcolor="black",role="Undefined"];
n84[label="#vf.6 : isend",shape="ellipse"];
n85[label="#vk.6 : coerce[!KU( ~sn )]",shape="ellipse"];
n86[label="#vl.6 : irecv",shape="ellipse"];
n96[shape="record",label="{{<n87> In( \<$idCA, $id, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~sk), PR1, ~sn, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i, $j\>\l)\l|<n88> In( SI3 )|<n89> In( \<$rootCA, $idCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA), PU1, ~sn.1, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i0, $j0\>\l)\l|<n90> In( SI2 )|<n91> !Logger_s( $idL,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~skL, pk(~skL)\l)\l|<n92> !Root_CA( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PK1\l)\l|<n93> !Log( $idL, $log_id\l)\l}|{<n94> #vr.6 : add_preC_to_log[Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerComputesAddLogStmt( $idL, $log_id, \<$idCA, $id, pk(~sk), ~sn\>, $sct1 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerComputesAddLog( $idL, $log_id, \<$idCA, $id, pk(~sk), PR1, ~sn, $i, $j\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<\<\<$idCA, $id, pk(~sk), PR1, ~sn, $i, $j\>, SI3\>, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, pk(~skCA), PU1, ~sn.1, $i0, $j0\>, SI2\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sct1\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerAsserts( $idL, \<$idL, 'SCT', $sct1, SI5\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $sct1 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckIssuedTime( $sct1, $i ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckValidUntil( $sct1, $j )]\l}|{<n95> Out( \<$idL, 'SCT', $sct1, SI5\> )}}",fillcolor="#08a358",style="filled",fontcolor="white",role="Undefined"];
n97[label="#vf.7 : isend",shape="ellipse"];
n98[label="#vk.7 : coerce[!KU( pk(~skCA) )]",shape="ellipse"];
n99[label="#vr.7 : d_0_snd",shape="ellipse"];
n100[label="#vf.8 : isend",shape="ellipse"];
n101[label="#vk.8 : coerce[!KU( pk(~sk) )]",shape="ellipse"];
n102[label="#vr.8 : d_0_snd",shape="ellipse"];
n103[label="#vr.9 : d_0_snd",shape="ellipse"];
n113[shape="record",label="{{<n104> In( \<$idCA, $id, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~sk), PR1, ~sn, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i, $j\>\l)\l|<n105> In( SI3 )|<n106> In( \<$rootCA, $idCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA), PU1, ~sn.1, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i0, $j0\>\l)\l|<n107> In( SI2 )|<n108> !Logger_s( $idL2,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~skL.1, PK2\l)\l|<n109> !Root_CA( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PK1\l)\l|<n110> !Log( $idL2,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$log_id.1\l)\l}|{<n111> #vr.10 : add_preC_to_log[Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerComputesAddLogStmt( $idL2, $log_id.1, \<$idCA, $id, pk(~sk), ~sn\>, $sct2 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerComputesAddLog( $idL2, $log_id.1, \<$idCA, $id, pk(~sk), PR1, ~sn, $i, $j\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<\<\<$idCA, $id, pk(~sk), PR1, ~sn, $i, $j\>, SI3\>, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, pk(~skCA), PU1, ~sn.1, $i0, $j0\>, SI2\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sct2\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LoggerAsserts( $idL2, \<$idL2, 'SCT', $sct2, SI4\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $sct2 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckIssuedTime( $sct2, $i ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckValidUntil( $sct2, $j )]\l}|{<n112> Out( \<$idL2, 'SCT', $sct2, SI4\> )}}",fillcolor="#08a358",style="filled",fontcolor="white",role="Undefined"];
n114[label="#vr.11 : d_0_snd",shape="ellipse"];
n115[label="#vf.12 : isend",shape="ellipse"];
n116[label="#vr.12 : d_0_snd",shape="ellipse"];
n117[label="#vf.13 : isend",shape="ellipse"];
n118[label="#vr.13 : d_0_snd",shape="ellipse"];
n119[label="#vf.14 : isend",shape="ellipse"];
n123[shape="record",label="{{<n120> !Logger_s( $idL2, ~skL.1, PK2 )}|{<n121> #vr.14 : Start_Log[StartedLog( $idL2, $log_id.1 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HonestStartedLog( $idL2, $log_id.1 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.9 )]\l}|{<n122> !Log( $idL2, $log_id.1 )}}",fillcolor="#08a358",style="filled",fontcolor="white",role="Undefined"];
n124[label="#vf.15 : isend",shape="ellipse"];
n134[shape="record",label="{{<n125> !CA_s0( $idCA, ~skCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, pk(~skCA), \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PU1, ~sn.1, $i0, $j0\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SI2\l)\l|<n126> In( \<$idL, 'SCT', \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sct1, SI5\>\l)\l|<n127> In( \<$idL2, 'SCT', \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$sct2, SI4\>\l)\l|<n128> !Logger( $idL,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skL)\l)\l|<n129> !Logger( $idL2, PK2\l)\l|<n130> Certificate_Store( $idCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$idCA, $id, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~sk), PR1, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~sn, $i, $j\>, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SI3\>\l)\l}|{<n131> #vr.15 : PubKeyCertify[Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Certified( $idCA, $idL, \<$idL, 'SCT', $sct1, SI5\>, $idL2, \<$idL2, 'SCT', $sct2, SI4\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CAAsserts( $idCA, \<$idCA, $id, pk(~sk), ~sn\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.10 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckIssuedTime( $now.10, $i ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CheckValidUntil( $now.10, $j ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Restr_PubKeyCertify_1( $idL, $idL2 )]\l}|{<n132> Out( \<$idCA, $id, pk(~sk), 'pubKey', ~sn, $i, $j, \<$idL, 'SCT', $sct1, SI5\>, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$idL2, 'SCT', $sct2, SI4\>\l)\l|<n133> Out( SI1 )}}",fillcolor="#c871ff",style="filled",fontcolor="black",role="Undefined"];
n144[shape="record",label="{{<n135> !DomainOwner( $id,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~sk)\l)\l|<n136> !CA_s0( $idCA, ~skCA, pk(~skCA),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, pk(~skCA), PU1, ~sn.1, $i0, $j0\>, SI2\l)\l|<n137> Fr( ~sn )}|{<n138> #vr.16 : PreCertify[PreCertified( $idCA, \<\<$idCA, $id, pk(~sk), PR1, ~sn, $i, $j\>, SI3\>\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GroundTruth( $idCA, \<$idCA, $id, pk(~sk), ~sn\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Asserts_PKI( $idCA, \<$idCA, $id, pk(~sk), ~sn\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $i )]\l}|{<n139> Out( \<$idCA, $id, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~sk), PR1, ~sn, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i, $j\>\l)\l|<n140> Out( SI3 )|<n141> Certificate_Store( $idCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$idCA, $id, pk(~sk), PR1, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~sn, $i, $j\>, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SI3\>\l)\l|<n142> Out( \<$rootCA, $idCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA), PU1, ~sn.1, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i0, $j0\>\l)\l|<n143> Out( SI2 )}}",fillcolor="#c871ff",style="filled",fontcolor="black",role="Undefined"];
n149[shape="record",label="{{<n145> Fr( ~sk )}|{<n146> #vr.17 : Domain_Owner_Init[Time( $now.11 )]}|{<n147> !DomainOwner( $id, pk(~sk) )|<n148> Out( pk(~sk) )}}",fillcolor="#c6c6c6",style="filled",fontcolor="black",role="Undefined"];
n150[label="#vf.18 : isend",shape="ellipse"];
n151[label="#vr.18 : d_0_snd",shape="ellipse"];
n152[label="#vf.19 : isend",shape="ellipse"];
n153[label="#vr.19 : d_0_snd",shape="ellipse"];
n154[label="#vf.20 : isend",shape="ellipse"];
n155[label="#vr.20 : d_0_snd",shape="ellipse"];
n156[label="#vf.21 : isend",shape="ellipse"];
n157[label="#vr.21 : d_0_snd",shape="ellipse"];
n158[label="#vf.22 : isend",shape="ellipse"];
n159[label="#vf.23 : isend",shape="ellipse"];
n160[label="#vr.23 : d_0_snd",shape="ellipse"];
n161[label="#vf.24 : isend",shape="ellipse"];
n162[label="#vr.24 : d_0_snd",shape="ellipse"];
n163[label="#vf.25 : isend",shape="ellipse"];
n164[label="#vr.25 : d_0_snd",shape="ellipse"];
n165[label="#vf.26 : isend",shape="ellipse"];
n166[label="#vr.26 : d_0_snd",shape="ellipse"];
n167[label="#vf.27 : isend",shape="ellipse"];
n9:n8 -> n32:n29[style="bold",weight="10.0",color="gray50"];
n9:n8 -> n96:n93[style="bold",weight="10.0",color="gray50"];
n15:n14 -> n5:n0[style="bold",weight="10.0",color="gray50"];
n16 -> n5:n3[color="gray30"];
n22:n20 -> n9:n6[style="bold",weight="10.0",color="gray50"];
n22:n20 -> n15:n10[style="bold",weight="10.0",color="gray50"];
n22:n20 -> n32:n27[style="bold",weight="10.0",color="gray50"];
n22:n20 -> n96:n91[style="bold",weight="10.0",color="gray50"];
n22:n21 -> n5:n1[style="bold",weight="10.0",color="gray50"];
n22:n21 -> n40:n37[style="bold",weight="10.0",color="gray50"];
n22:n21 -> n53:n48[style="bold",weight="10.0",color="gray50"];
n22:n21 -> n134:n128[style="bold",weight="10.0",color="gray50"];
n34 -> n99[color="orangered2"];
n40:n39 -> n15:n12[style="bold",weight="10.0",color="gray50"];
n42 -> n114[color="orangered2"];
n53:n51 -> n5:n2[style="bold",weight="10.0",color="gray50"];
n63:n61 -> n83:n76[style="bold",weight="10.0",color="gray50"];
n63:n62 -> n32:n28[style="bold",weight="10.0",color="gray50"];
n63:n62 -> n53:n43[style="bold",weight="10.0",color="gray50"];
n63:n62 -> n96:n92[style="bold",weight="10.0",color="gray50"];
n63:n62 -> n113:n109[style="bold",weight="10.0",color="gray50"];
n64 -> n40:n36[color="gray30"];
n70:n68 -> n113:n108[style="bold",weight="10.0",color="gray50"];
n70:n68 -> n123:n120[style="bold",weight="10.0",color="gray50"];
n70:n69 -> n53:n49[style="bold",weight="10.0",color="gray50"];
n70:n69 -> n134:n129[style="bold",weight="10.0",color="gray50"];
n71 -> n53:n44[color="gray30"];
n73 -> n151[color="orangered2"];
n83:n78 -> n73[color="gray30"];
n83:n79 -> n17[color="orangered2"];
n83:n81 -> n134:n125[style="bold",weight="10.0",color="gray50"];
n83:n81 -> n144:n136[style="bold",weight="10.0",color="gray50"];
n84 -> n53:n45[color="gray30"];
n86 -> n160[color="orangered2"];
n96:n95 -> n34[color="gray30"];
n97 -> n53:n46[color="gray30"];
n99 -> n102[color="orangered2"];
n100 -> n53:n47[color="gray30"];
n102 -> n103[color="orangered2"];
n103 -> n33[color="orangered2"];
n113:n112 -> n42[color="gray30"];
n114 -> n116[color="orangered2"];
n115 -> n32:n23[color="gray30"];
n116 -> n118[color="orangered2"];
n117 -> n32:n24[color="gray30"];
n118 -> n41[color="orangered2"];
n119 -> n32:n25[color="gray30"];
n123:n122 -> n113:n110[style="bold",weight="10.0",color="gray50"];
n124 -> n32:n26[color="gray30"];
n134:n133 -> n54[color="orangered2"];
n144:n139 -> n86[color="gray30"];
n144:n140 -> n65[color="orangered2"];
n144:n141 -> n134:n130[style="bold",weight="10.0"];
n149:n147 -> n144:n135[style="bold",weight="10.0",color="gray50"];
n149:n148 -> n101[color="orangered2"];
n150 -> n96:n87[color="gray30"];
n151 -> n153[color="orangered2"];
n152 -> n96:n88[color="gray30"];
n153 -> n98[color="orangered2"];
n153 -> n155[color="orangered2"];
n154 -> n96:n89[color="gray30"];
n155 -> n157[color="orangered2"];
n156 -> n96:n90[color="gray30"];
n157 -> n72[color="orangered2"];
n158 -> n113:n104[color="gray30"];
n159 -> n113:n105[color="gray30"];
n160 -> n162[color="orangered2"];
n161 -> n113:n106[color="gray30"];
n162 -> n164[color="orangered2"];
n163 -> n113:n107[color="gray30"];
n164 -> n166[color="orangered2"];
n165 -> n134:n126[color="gray30"];
n166 -> n85[color="orangered2"];
n167 -> n134:n127[color="gray30"];
n9:n7 -> n15:n13[color="black",style="dashed"];
n17 -> n84[color="red",style="dashed"];
n17 -> n124[color="red",style="dashed"];
n17 -> n156[color="red",style="dashed"];
n17 -> n163[color="red",style="dashed"];
n32:n30 -> n15:n13[color="black",style="dashed"];
n33 -> n97[color="red",style="dashed"];
n33 -> n165[color="red",style="dashed"];
n34 -> n97[color="red",style="dashed"];
n34 -> n165[color="red",style="dashed"];
n41 -> n97[color="red",style="dashed"];
n41 -> n167[color="red",style="dashed"];
n42 -> n97[color="red",style="dashed"];
n42 -> n167[color="red",style="dashed"];
n54 -> n100[color="red",style="dashed"];
n65 -> n117[color="red",style="dashed"];
n65 -> n152[color="red",style="dashed"];
n65 -> n159[color="red",style="dashed"];
n72 -> n71[color="red",style="dashed"];
n72 -> n119[color="red",style="dashed"];
n72 -> n154[color="red",style="dashed"];
n72 -> n161[color="red",style="dashed"];
n73 -> n71[color="red",style="dashed"];
n73 -> n119[color="red",style="dashed"];
n73 -> n154[color="red",style="dashed"];
n73 -> n161[color="red",style="dashed"];
n85 -> n97[color="red",style="dashed"];
n85 -> n115[color="red",style="dashed"];
n85 -> n150[color="red",style="dashed"];
n85 -> n158[color="red",style="dashed"];
n86 -> n115[color="red",style="dashed"];
n86 -> n150[color="red",style="dashed"];
n86 -> n158[color="red",style="dashed"];
n98 -> n71[color="red",style="dashed"];
n98 -> n119[color="red",style="dashed"];
n98 -> n154[color="red",style="dashed"];
n98 -> n161[color="red",style="dashed"];
n99 -> n97[color="red",style="dashed"];
n99 -> n165[color="red",style="dashed"];
n101 -> n97[color="red",style="dashed"];
n101 -> n115[color="red",style="dashed"];
n101 -> n150[color="red",style="dashed"];
n101 -> n158[color="red",style="dashed"];
n102 -> n97[color="red",style="dashed"];
n102 -> n165[color="red",style="dashed"];
n114 -> n97[color="red",style="dashed"];
n114 -> n167[color="red",style="dashed"];
n116 -> n97[color="red",style="dashed"];
n116 -> n167[color="red",style="dashed"];
n151 -> n71[color="red",style="dashed"];
n151 -> n119[color="red",style="dashed"];
n151 -> n154[color="red",style="dashed"];
n151 -> n161[color="red",style="dashed"];
n153 -> n71[color="red",style="dashed"];
n153 -> n119[color="red",style="dashed"];
n153 -> n154[color="red",style="dashed"];
n153 -> n161[color="red",style="dashed"];
n155 -> n71[color="red",style="dashed"];
n155 -> n119[color="red",style="dashed"];
n155 -> n154[color="red",style="dashed"];
n155 -> n161[color="red",style="dashed"];
n157 -> n71[color="red",style="dashed"];
n157 -> n119[color="red",style="dashed"];
n157 -> n154[color="red",style="dashed"];
n157 -> n161[color="red",style="dashed"];
n160 -> n115[color="red",style="dashed"];
n160 -> n150[color="red",style="dashed"];
n160 -> n158[color="red",style="dashed"];
n162 -> n115[color="red",style="dashed"];
n162 -> n150[color="red",style="dashed"];
n162 -> n158[color="red",style="dashed"];
n164 -> n115[color="red",style="dashed"];
n164 -> n150[color="red",style="dashed"];
n164 -> n158[color="red",style="dashed"];
n166 -> n115[color="red",style="dashed"];
n166 -> n150[color="red",style="dashed"];
n166 -> n158[color="red",style="dashed"];
{
rank="sink";
n168[shape="plain",label=<<TABLE BORDER="1" CELLBORDER="0" CELLSPACING="3" CELLPADDING="1"><TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">PK1</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">pk(~skCA.1)</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">PK2</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">pk(~skL.1)</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">PR1</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">'pre-cert'</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">PU1</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">'pubKey-CA'</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">SI2</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">sign(&lt;$rootCA, $idCA, pk(~skCA), PU1, ~sn.1, $i0, $j0&gt;, ~skCA.1)</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">SI3</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">sign(&lt;$idCA, $id, pk(~sk), PR1, ~sn, $i, $j&gt;, ~skCA)</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">SI4</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">sign(&lt;$idL2, 'SCT', $sct2, $idCA, $id, pk(~sk), ~sn, $i, $j&gt;,<BR ALIGN="LEFT"/> &#32;&#32;&#32;&#32;~skL.1)</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">SI5</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">sign(&lt;$idL, 'SCT', $sct1, $idCA, $id, pk(~sk), ~sn, $i, $j&gt;, ~skL)</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">SI1</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">sign(&lt;$idCA, $id, pk(~sk), 'pubKey', ~sn, $i, $j, <BR ALIGN="LEFT"/> &#32;&#32;&#32;&#32;&#32;&lt;$idL, 'SCT', $sct1, SI5&gt;, $idL2, 'SCT', $sct2, SI4&gt;,<BR ALIGN="LEFT"/> &#32;&#32;&#32;&#32;~skCA)</TD></TR></TABLE>>];

}
n5:n4 -> n168[style="invis"];

}
