digraph "trace_ct_SL2-AS0-CL0-A1-C1-NB_san_PKIExt_external_check_true-external_check_true-Root_CA_Init-Domain_Owner_Init-CA_Init-external_check_true-c_sign-CA_Init-compromiseCA-PreCertify-CA_Init-CA_Init_case_1-Domain_Owner_Init" {
nodesep="0.3";
ranksep="0.3";
node[fontsize="8",fontname="Helvetica",width="0.3",height="0.2"];
edge[fontsize="8",fontname="Helvetica"];
n6[shape="record",label="{{<n0> In( \<$idCA, $id, pk(~sk), \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'pubKey', ~sn, $i, $j, sct1, sct2\>\l)\l|<n1> In( SI2 )|<n2> In( \<$rootCA, $idCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA), PU1, ~sn.1, $i0, $j0\l&nbsp;&nbsp;&nbsp;&nbsp;\>\l)\l|<n3> In( SI1 )|<n4> !Root_CA( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PK1\l)\l}|{<n5> #t : external_check_true[StatementCheckedExternally( \<$rootCA, $idCA, pk(~skCA), PU1, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~sn.1, $i0, $j0\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$idCA, $id, pk(~sk), ~sn\>\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BenignCert( $idCA, \<$idCA, $id, pk(~sk), ~sn\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Asserts_PKI( $idCA, \<$idCA, $id, pk(~sk), ~sn\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Eq( true, true ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now )]\l}}",fillcolor="#d5d897",style="filled",fontcolor="black",role="Undefined"];
n16[shape="record",label="{{<n7> !DomainOwner( $id,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~sk)\l)\l|<n8> !CA_s0( $idCA, ~skCA, pk(~skCA),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, pk(~skCA), PU1, ~sn.1, $i0, $j0\>, SI1\l)\l|<n9> Fr( ~sn )}|{<n10> #t0 : PreCertify[PreCertified( $idCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<\<$idCA, $id, pk(~sk), 'pre-cert', ~sn, $now.1, $j.1\>, SI3\>\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GroundTruth( $idCA, \<$idCA, $id, pk(~sk), ~sn\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Asserts_PKI( $idCA, \<$idCA, $id, pk(~sk), ~sn\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.1 )]\l}|{<n11> Out( \<$idCA, $id, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~sk), 'pre-cert', \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~sn, $now.1, $j.1\>\l)\l|<n12> Out( SI3 )|<n13> Certificate_Store( $idCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$idCA, $id, pk(~sk), \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'pre-cert', ~sn, $now.1, $j.1\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\>, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SI3\>\l)\l|<n14> Out( \<$rootCA, $idCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA), PU1, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~sn.1, $i0, $j0\>\l)\l|<n15> Out( SI1 )}}",fillcolor="#c871ff",style="filled",fontcolor="black",role="Undefined"];
n17[label="#vf : isend",shape="ellipse"];
n18[label="#vk : c_sign[!KU( SI2 )]",shape="ellipse"];
n27[shape="record",label="{{<n19> Fr( ~skCA.1 )|<n20> Fr( ~sn.2 )}|{<n21> #vr : Root_CA_Init[CA_Registered( $rootCA, ~skCA.1, PK1 ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Root_CA_Init( $rootCA ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.2 )]\l}|{<n22> Out( \<$rootCA, $rootCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PK1, 'selfCert', ~sn.2, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$now.2, $j.2\>\l)\l|<n23> Out( sign(\<$rootCA, $rootCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PK1, 'selfCert', ~sn.2, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$now.2, $j.2\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~skCA.1)\l)\l|<n24> Out( \<$rootCA, PK1\>\l)\l|<n25> !Root_CA_s0( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;~skCA.1, PK1\l)\l|<n26> !Root_CA( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PK1\l)\l}}",fillcolor="#620c97",style="filled",fontcolor="white",role="Undefined"];
n28[label="#vf.1 : isend",shape="ellipse"];
n29[label="#vk.1 : coerce[!KU( SI1 )]",shape="ellipse"];
n34[shape="record",label="{{<n30> Fr( ~sk )}|{<n31> #vr.1 : Domain_Owner_Init[Time( $now.3 )]}|{<n32> !DomainOwner( $id, pk(~sk) )|<n33> Out( pk(~sk) )}}",fillcolor="#c6c6c6",style="filled",fontcolor="black",role="Undefined"];
n35[label="#vf.2 : isend",shape="ellipse"];
n36[label="#vk.2 : coerce[!KU( ~skCA )]",shape="ellipse"];
n46[shape="record",label="{{<n37> Fr( ~skCA )|<n38> Fr( ~sn.1 )|<n39> !Root_CA_s0( $rootCA, ~skCA.1, PK1 )}|{<n40> #vr.2 : CA_Init[CA_Registered( $idCA, ~skCA, pk(~skCA) ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NonRoot_CA_Init( $idCA ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DocumentedCA( $rootCA, $idCA, \<$rootCA, $idCA, pk(~skCA), PU1, ~sn.1, $i0, $j0\> ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $i0 )]\l}|{<n41> Out( \<$rootCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$idCA, pk(~skCA), \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PU1, ~sn.1, $i0, $j0\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\>\l)\l|<n42> Out( SI1 )|<n43> Out( \<$idCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA)\>\l)\l|<n44> !CA_s0( $idCA, ~skCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, pk(~skCA), \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PU1, ~sn.1, $i0, $j0\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SI1\l)\l|<n45> !CA_Documentation( $rootCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$idCA,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\<$rootCA, $idCA, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pk(~skCA), PU1, ~sn.1, \l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$i0, $j0\>,\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SI1\l)\l}}",fillcolor="#c871ff",style="filled",fontcolor="black",role="Undefined"];
n47[label="#vf.3 : isend",shape="ellipse"];
n48[label="#vk.3 : coerce[!KU( ~sn )]",shape="ellipse"];
n49[label="#vl.3 : irecv",shape="ellipse"];
n53[shape="record",label="{{<n50> !CA_s0( $idCA, ~skCA, pk(~skCA), \<$rootCA, $idCA, pk(~skCA), PU1, ~sn.1, $i0, $j0\>, SI1\l)\l}|{<n51> #vr.3 : compromiseCA[CompromiseCA( $idCA ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Compromise( ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Corrupted( $idCA ),\l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Time( $now.4 )]\l}|{<n52> Out( ~skCA )}}",fillcolor="#d40808",style="filled",fontcolor="white",role="Undefined"];
n54[label="#vk.4 : coerce[!KU( ~sn.1 )]",shape="ellipse"];
n55[label="#vk.5 : coerce[!KU( pk(~skCA) )]",shape="ellipse"];
n56[label="#vk.6 : coerce[!KU( pk(~sk) )]",shape="ellipse"];
n57[label="#vr.9 : d_0_snd",shape="ellipse"];
n58[label="#vr.10 : d_0_snd",shape="ellipse"];
n59[label="#vr.11 : d_0_snd",shape="ellipse"];
n60[label="#vr.12 : d_0_snd",shape="ellipse"];
n61[label="!KU( sct1 ) @ #vk.25",shape="ellipse",color="gray"];
n62[label="!KU( sct2 ) @ #vk.26",shape="ellipse",color="gray"];
n16:n11 -> n48[color="orangered2"];
n17 -> n6:n0[color="gray30"];
n27:n25 -> n46:n39[style="bold",weight="10.0",color="gray50"];
n27:n26 -> n6:n4[style="bold",weight="10.0",color="gray50"];
n28 -> n6:n1[color="gray30"];
n34:n32 -> n16:n7[style="bold",weight="10.0",color="gray50"];
n34:n33 -> n56[color="orangered2"];
n35 -> n6:n2[color="gray30"];
n46:n41 -> n49[color="gray30"];
n46:n42 -> n29[color="orangered2"];
n46:n44 -> n16:n8[style="bold",weight="10.0",color="gray50"];
n46:n44 -> n53:n50[style="bold",weight="10.0",color="gray50"];
n47 -> n6:n3[color="gray30"];
n49 -> n57[color="orangered2"];
n53:n52 -> n36[color="orangered2"];
n57 -> n58[color="orangered2"];
n58 -> n55[color="orangered2"];
n58 -> n59[color="orangered2"];
n59 -> n60[color="orangered2"];
n60 -> n54[color="orangered2"];
n18 -> n28[color="red",style="dashed"];
n29 -> n47[color="red",style="dashed"];
n36 -> n18[color="red",style="dashed"];
n48 -> n17[color="red",style="dashed"];
n48 -> n18[color="red",style="dashed"];
n49 -> n35[color="red",style="dashed"];
n54 -> n35[color="red",style="dashed"];
n55 -> n35[color="red",style="dashed"];
n56 -> n17[color="red",style="dashed"];
n56 -> n18[color="red",style="dashed"];
n57 -> n35[color="red",style="dashed"];
n58 -> n35[color="red",style="dashed"];
n59 -> n35[color="red",style="dashed"];
n60 -> n35[color="red",style="dashed"];
n61 -> n17[color="red",style="dashed"];
n61 -> n18[color="red",style="dashed"];
n62 -> n17[color="red",style="dashed"];
n62 -> n18[color="red",style="dashed"];
{
rank="sink";
n63[shape="plain",label=<<TABLE BORDER="1" CELLBORDER="0" CELLSPACING="3" CELLPADDING="1"><TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">PK1</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">pk(~skCA.1)</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">PU1</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">'pubKey-CA'</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">SI1</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">sign(&lt;$rootCA, $idCA, pk(~skCA), PU1, ~sn.1, $i0, $j0&gt;, ~skCA.1)</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">SI2</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">sign(&lt;$idCA, $id, pk(~sk), 'pubKey', ~sn, $i, $j, sct1, sct2&gt;,<BR ALIGN="LEFT"/> &#32;&#32;&#32;&#32;~skCA)</TD></TR>
                                                                 <TR><TD ALIGN="LEFT" VALIGN="TOP"><FONT COLOR="#000000">SI3</FONT></TD> <TD ALIGN="LEFT" VALIGN="TOP">=</TD> <TD ALIGN="LEFT" VALIGN="TOP">sign(&lt;$idCA, $id, pk(~sk), 'pre-cert', ~sn, $now.1, $j.1&gt;, ~skCA)</TD></TR></TABLE>>];

}
n6:n5 -> n63[style="invis"];

}
